generator client {
  provider = "prisma-client"
  output   = "../node_modules/.prisma/client"
}

datasource db {
  provider = "sqlite"
}

model Family {
  id          String   @id @default(cuid())
  name        String
  industry    String?
  location    String?
  email       String?
  phone       String?
  description String?
  since       DateTime @default(now())
  status      String   @default("active") // active, inactive, pending
  paymentStatus String @default("pending") // paid, pending, no-invoices
  role        String   @default("consultant") // external-consul, consultant, personal-advisor
  
  members       Member[]
  tasks         Task[]
  consultations Consultation[]
  services      FamilyService[]
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Member {
  id       String @id @default(cuid())
  name     String
  role     String?
  email    String?
  avatar   String?
  familyId String
  family   Family @relation(fields: [familyId], references: [id], onDelete: Cascade)
}

model Service {
  id            String   @id @default(cuid())
  name          String
  description   String?
  price         String?
  priceAmount   Decimal?
  priceModel    String?
  duration      String?
  category      String?
  status        String   @default("draft") // active, draft, paused
  activeClients Int      @default(0)
  totalRevenue  Decimal  @default(0)
  rating        Float    @default(0)
  reviews       Int      @default(0)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model FamilyService {
  id        String   @id @default(cuid())
  name      String
  status    String // Active, In Progress, Scheduled
  progress  Int      @default(0)
  price     String?
  startDate DateTime?
  
  familyId  String
  family    Family   @relation(fields: [familyId], references: [id], onDelete: Cascade)
}

model Consultation {
  id            String   @id @default(cuid())
  title         String
  date          DateTime
  time          String?
  duration      String?
  type          String? // Video Call, In-Person
  status        String   @default("scheduled") // scheduled, confirmed, pending, completed, cancelled
  paymentStatus String   @default("awaiting") // paid, awaiting, overdue
  price         String?
  notes         String?
  meetingLink   String?
  location      String?
  
  familyId      String
  family        Family   @relation(fields: [familyId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Resource {
  id          String   @id @default(cuid())
  title       String
  type        String // document, article, video, etc.
  category    String?
  description String?
  isFeatured  Boolean  @default(false)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ConstitutionTemplate {
  id          String   @id @default(cuid())
  title       String
  description String?
  sections    Json     // Array of sections with title, content, status
  isDefault   Boolean  @default(false)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model AvailabilitySlot {
  id           String    @id @default(cuid())
  dayOfWeek    Int       // 0=Sunday, 1=Monday, etc.
  startTime    String    // "09:00"
  endTime      String    // "17:00"
  isRecurring  Boolean   @default(true)
  specificDate DateTime? // If not recurring, specific date
  
  createdAt    DateTime  @default(now())
  updatedAt    DateTime  @updatedAt
}

model Task {
  id        String   @id @default(cuid())
  title     String
  status    String   @default("todo")
  dueDate   DateTime?
  
  familyId  String
  family    Family   @relation(fields: [familyId], references: [id], onDelete: Cascade)
  
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
