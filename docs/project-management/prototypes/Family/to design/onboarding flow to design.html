<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Family Governance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3B82F6',
                        secondary: '#6B7280',
                    }
                }
            }
        }
    </script>
    <style>
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header Navigation -->
    <header class="bg-white shadow-sm border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center space-x-8">
                    <h1 class="text-xl font-semibold">RE:Family</h1>
                    <nav class="flex space-x-4">
                        <a href="#" class="text-gray-900 font-medium">üè† Dashboard</a>
                        <a href="#" class="text-gray-500 hover:text-gray-900">Governance ‚ñæ</a>
                        <a href="#" class="text-gray-500 hover:text-gray-900">Development ‚ñæ</a>
                        <a href="#" class="text-gray-500 hover:text-gray-900">Family Affairs ‚ñæ</a>
                        <a href="#" class="text-gray-500 hover:text-gray-900">Tools ‚ñæ</a>
                    </nav>
                </div>
                <div class="flex items-center space-x-4">
                    <button class="text-gray-500 hover:text-gray-900">üîî</button>
                    <div class="w-8 h-8 bg-gray-300 rounded-full"></div>
                </div>
            </div>
        </div>
    </header>

    <!-- Breadcrumb -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-4">
        <div class="flex items-center text-sm text-gray-500">
            <a href="#" class="hover:text-gray-900">üè† Home</a>
            <span class="mx-2">‚Ä∫</span>
            <span class="text-gray-900">Dashboard</span>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-6">
        <!-- Welcome Banner -->
        <div class="bg-gradient-to-r from-orange-400 to-orange-500 rounded-lg p-6 text-white mb-6">
            <div class="flex items-center">
                <span class="text-xl font-semibold mr-2">Welcome Back,</span>
                <div class="w-8 h-8 bg-white rounded-full mr-2"></div>
                <span class="text-xl font-semibold">Anastasiia Bronina</span>
                <span class="ml-4">You Have</span>
                <span class="ml-2 font-semibold">üìÖ 0 Meetings</span>
                <span class="ml-4 font-semibold">‚úì 2 Tasks</span>
                <span class="ml-4 font-semibold">and ‚ö° 0 Pending Decisions</span>
            </div>
        </div>

        <!-- Family Members Setup Banner - Prerequisite (Shown when members < 2) -->
        <div id="familyMembersAlert" class="bg-purple-50 border-2 border-purple-200 rounded-lg p-6 mb-6 hidden">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="flex items-center mb-2">
                        <span class="text-2xl mr-2">üë•</span>
                        <h3 class="text-xl font-bold text-purple-900">Invite Your Family Members</h3>
                        <span class="ml-3 px-3 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full">Required First</span>
                    </div>
                    <p class="text-purple-800 mb-4">Before setting up your Family Constitution, you need to invite family members and assign their roles. A minimum of 2 members is required to begin constitution work.</p>
                    <div class="flex items-center space-x-4">
                        <button onclick="window.location.href='02-family-members.html'" class="bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors font-medium">
                            Invite Family Members ‚Üí
                        </button>
                    </div>
                </div>
                <div class="ml-6">
                    <div class="bg-white rounded-lg p-4 border border-purple-200">
                        <div class="text-sm text-gray-600 mb-2">Current Members</div>
                        <div class="text-3xl font-bold text-purple-600">1</div>
                        <div class="text-xs text-red-500 mt-1 font-medium">Minimum 2 needed</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Constitution Setup Banner - Not Started State -->
        <div id="constitutionBanner" class="bg-blue-50 border-2 border-blue-200 rounded-lg p-6 mb-6">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="flex items-center mb-2">
                        <span class="text-2xl mr-2">üìú</span>
                        <h3 class="text-xl font-bold text-blue-900">Set Up Your Family Constitution</h3>
                        <span class="ml-3 px-3 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full">Action Required</span>
                    </div>
                    <p class="text-blue-800 mb-4">Define how your family handles conflicts, makes decisions, and maintains governance. Create frameworks tailored to your family's values and needs.</p>

                    <!-- Horizontal Progress Steps (Duolingo-style) -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between max-w-4xl">
                            <!-- Step 1 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep1" class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white font-bold shadow-lg relative">
                                    <span class="text-xl">‚úì</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Profile</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine1"></div>

                            <!-- Step 2 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep2" class="w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white font-bold shadow-lg">
                                    <span class="text-xl">‚úì</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Members</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine2"></div>

                            <!-- Step 3 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep3" class="w-12 h-12 rounded-full bg-blue-500 border-4 border-blue-300 flex items-center justify-center text-white font-bold shadow-lg">
                                    <span class="text-lg">3</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Why</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine3"></div>

                            <!-- Step 4 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep4" class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow">
                                    <span class="text-lg">4</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Assessment</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine4"></div>

                            <!-- Step 5 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep5" class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow">
                                    <span class="text-lg">5</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Values</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine5"></div>

                            <!-- Step 6 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep6" class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow">
                                    <span class="text-lg">6</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Decisions</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine6"></div>

                            <!-- Step 7 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep7" class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow">
                                    <span class="text-lg">7</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Succession</span>
                            </div>
                            <div class="flex-1 h-1 bg-gray-300 mx-2" id="progressLine7"></div>

                            <!-- Step 8 -->
                            <div class="flex flex-col items-center">
                                <div id="progressStep8" class="w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow">
                                    <span class="text-lg">8</span>
                                </div>
                                <span class="text-xs text-gray-600 mt-1">Launch</span>
                            </div>
                        </div>
                    </div>

                    <div class="flex items-center justify-between">
                        <button onclick="openOnboardingModal()" class="bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium">
                            Get Started ‚Üí
                        </button>

                        <!-- Invite Status & Resend -->
                        <div class="flex items-center space-x-3">
                            <div class="bg-white border border-blue-200 rounded-lg px-4 py-2 shadow-sm">
                                <div class="flex items-center space-x-2">
                                    <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z" />
                                    </svg>
                                    <div class="text-sm">
                                        <span class="text-gray-600">Registered:</span>
                                        <span class="font-bold text-blue-900 ml-1">5 of 8</span>
                                    </div>
                                </div>
                            </div>
                            <button onclick="resendInvites(event)" class="flex items-center space-x-2 text-blue-700 hover:text-blue-900 text-sm font-medium border-2 border-blue-300 px-4 py-2 rounded-lg hover:bg-blue-50 transition-all shadow-sm hover:shadow-md disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:bg-transparent">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                                </svg>
                                <span>Resend Invites</span>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="ml-6">
                    <div class="bg-white rounded-lg p-4 border border-blue-200">
                        <div class="text-sm text-gray-600 mb-2">Setup Progress</div>
                        <div id="dashboardProgressPercent" class="text-3xl font-bold text-blue-600">0%</div>
                        <div id="dashboardProgressStatus" class="text-xs text-gray-500 mt-1">Not started</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Onboarding Modal (Outside of banner) -->
        <div id="onboardingModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden p-4">
            <div class="bg-white rounded-lg shadow-xl max-w-6xl w-full relative animate-fadeIn max-h-[90vh] overflow-hidden flex flex-col">
                <button onclick="closeOnboardingModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-2xl z-20">&times;</button>

                <!-- Progress Bar -->
                <div class="bg-white rounded-t-lg shadow p-4 border-b">
                    <div class="flex items-center justify-between mb-2">
                        <span class="text-sm font-medium text-gray-700">Progress</span>
                        <span class="text-sm text-gray-500" id="stepIndicator">Step <span id="completedSteps">1</span> of 8</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div id="progressBar" class="bg-blue-600 h-2 rounded-full transition-all duration-300" style="width: 14%"></div>
                    </div>
                </div>

                <!-- Horizontal Step Boxes -->
                <div class="p-6 overflow-x-auto bg-gray-50">
                    <div id="horizontalStepsContainer" class="flex gap-4 pb-4 min-w-max mx-auto justify-center"></div>
                </div>

                <!-- Expanded Step Content Area -->
                <div id="expandedStepContent" class="flex-1 overflow-y-auto px-6 pb-6">
                    <!-- Content will be dynamically inserted here -->
                </div>

                                    <script>
                                    const stepsData = [
                                      {
                                        title: 'Step 1. Create Family Profile',
                                        icon: '‚úÖ',
                                        content: `<div class="mb-4">You have created your family in Family Governance ‚Äî the first step toward your family‚Äôs future is already done!</div>`,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 2. Invite Family Members',
                                        icon: 'üë•',
                                        content: `<div class="mb-4">Now let's invite your family to the profile. They will need to follow the link and confirm their email.</div>`,
                                        cta: 'Continue',
                                        extra: `<button onclick="goToInviteFlow()" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors mr-auto">Invite</button>`
                                      },
                                      {
                                        title: 'Step 3. Understanding Why It Matters',
                                        icon: 'üìñ',
                                        content: `
                                          <div class="text-center mb-6">
                                            <p class="text-gray-700 text-base">A <strong>Family Constitution</strong> is a set of rules that helps your family maintain business and relationships for generations ahead</p>
                                          </div>

                                          <!-- What's Inside Section -->
                                          <div class="mb-6">
                                            <h4 class="font-bold text-lg mb-4 text-center">What's Inside?</h4>
                                            <div class="grid grid-cols-2 gap-3">
                                              <div class="border-2 border-blue-200 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-blue-100 text-center hover:shadow-lg transition-shadow">
                                                <div class="text-3xl mb-2">üéØ</div>
                                                <div class="font-semibold text-sm">Values & Mission</div>
                                                <div class="text-xs text-gray-600 mt-1">What we stand for</div>
                                              </div>
                                              <div class="border-2 border-blue-200 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-blue-100 text-center hover:shadow-lg transition-shadow">
                                                <div class="text-3xl mb-2">‚öñÔ∏è</div>
                                                <div class="font-semibold text-sm">Governance Rules</div>
                                                <div class="text-xs text-gray-600 mt-1">Who decides what</div>
                                              </div>
                                              <div class="border-2 border-blue-200 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-blue-100 text-center hover:shadow-lg transition-shadow">
                                                <div class="text-3xl mb-2">üìä</div>
                                                <div class="font-semibold text-sm">Business Succession</div>
                                                <div class="text-xs text-gray-600 mt-1">Passing to next gen</div>
                                              </div>
                                              <div class="border-2 border-blue-200 rounded-lg p-4 bg-gradient-to-br from-blue-50 to-blue-100 text-center hover:shadow-lg transition-shadow">
                                                <div class="text-3xl mb-2">ü§ù</div>
                                                <div class="font-semibold text-sm">Conflict Resolution</div>
                                                <div class="text-xs text-gray-600 mt-1">Without courts & drama</div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Why It Matters Section -->
                                          <div class="bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-lg p-5 mb-6">
                                            <h4 class="font-bold text-lg mb-3 text-center text-red-900">Why It Matters?</h4>
                                            <div class="text-center mb-4">
                                              <div class="inline-block bg-white rounded-lg p-4 shadow-md">
                                                <div class="text-5xl font-bold text-red-600">90%</div>
                                                <div class="text-sm text-gray-700 mt-1">of family businesses fail by 3rd generation</div>
                                              </div>
                                            </div>
                                            <div class="text-sm text-gray-800 text-center font-medium mb-3">Constitution is a family agreement that:</div>
                                            <div class="grid grid-cols-2 gap-3 text-sm">
                                              <div class="flex items-start space-x-2">
                                                <span class="text-green-600 font-bold">‚Üí</span>
                                                <span>Prevents conflicts over money & power</span>
                                              </div>
                                              <div class="flex items-start space-x-2">
                                                <span class="text-green-600 font-bold">‚Üí</span>
                                                <span>Prepares next generation</span>
                                              </div>
                                              <div class="flex items-start space-x-2">
                                                <span class="text-green-600 font-bold">‚Üí</span>
                                                <span>Protects business in disputes</span>
                                              </div>
                                              <div class="flex items-start space-x-2">
                                                <span class="text-green-600 font-bold">‚Üí</span>
                                                <span>Maintains family unity</span>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Outcome Section -->
                                          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-4 mb-6 text-center">
                                            <div class="text-3xl mb-2">‚ú®</div>
                                            <h4 class="font-bold text-lg mb-2 text-green-900">Outcome</h4>
                                            <p class="text-sm text-gray-700">Clear rules of the game understood by everyone ‚Äî from founders to grandchildren</p>
                                          </div>

                                          <!-- What's Next Section -->
                                          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-lg p-5">
                                            <h4 class="font-bold text-lg mb-4 text-center text-blue-900">What's Next?</h4>
                                            <p class="text-sm text-center mb-4 text-gray-700">You'll go through 4 work phases to build your constitution:</p>
                                            <div class="grid grid-cols-4 gap-2">
                                              <div class="text-center">
                                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-2 font-bold text-lg shadow-lg">1</div>
                                                <div class="text-xs font-semibold">Values & Governance</div>
                                              </div>
                                              <div class="text-center">
                                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-2 font-bold text-lg shadow-lg">2</div>
                                                <div class="text-xs font-semibold">Decision Making & Conflicts</div>
                                              </div>
                                              <div class="text-center">
                                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-2 font-bold text-lg shadow-lg">3</div>
                                                <div class="text-xs font-semibold">Succession & Development</div>
                                              </div>
                                              <div class="text-center">
                                                <div class="w-12 h-12 bg-blue-600 text-white rounded-full flex items-center justify-center mx-auto mb-2 font-bold text-lg shadow-lg">4</div>
                                                <div class="text-xs font-semibold">Finalization & Launch</div>
                                              </div>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 4. Start with Assessment',
                                        icon: 'ü§ñ',
                                        content: `
                                          <div class="mb-6">
                                            <p class="text-center text-gray-700 text-base mb-2">Understand where you are now ‚Äî before building the rules</p>
                                            <p class="text-center text-sm text-gray-600 mb-6">You openly discuss family, business, and pain points. This step will be offered to each family member</p>
                                          </div>

                                          <!-- What You'll Discover Section -->
                                          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-5 mb-6">
                                            <h4 class="font-bold text-lg mb-4 text-center text-blue-900">What You'll Discover</h4>
                                            <div class="space-y-3">
                                              <div class="flex items-center space-x-3 bg-white rounded-lg p-3 shadow-sm">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">‚Üí</div>
                                                <span class="text-sm text-gray-800">Hidden risks of your business</span>
                                              </div>
                                              <div class="flex items-center space-x-3 bg-white rounded-lg p-3 shadow-sm">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">‚Üí</div>
                                                <span class="text-sm text-gray-800">Where family opinions may diverge</span>
                                              </div>
                                              <div class="flex items-center space-x-3 bg-white rounded-lg p-3 shadow-sm">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">‚Üí</div>
                                                <span class="text-sm text-gray-800">What to address first</span>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Assessment Methods Section -->
                                          <div class="mb-4">
                                            <h4 class="font-bold text-lg mb-4 text-center text-gray-900">Choose Assessment Method</h4>
                                            <div class="grid grid-cols-2 gap-3">
                                              <button onclick="selectAssessmentMethod('advisor')" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">üë®‚Äçüíº</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with an Advisor</div>
                                                <div class="text-xs text-gray-600">Professional expert helps identify key risks and growth points</div>
                                              </button>
                                              <button onclick="selectAssessmentMethod('ai')" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">ü§ñ</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with AI</div>
                                                <div class="text-xs text-gray-600">AI assistant guides the process, no in-person meetings</div>
                                              </button>
                                              <button onclick="selectAssessmentMethod('ai-auto')" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚ö°</div>
                                                <div class="font-semibold text-sm mb-1">Let AI do this step</div>
                                                <div class="text-xs text-gray-600">Upload data ‚Äî AI analyzes and delivers a ready report</div>
                                              </button>
                                              <button onclick="selectAssessmentMethod('manual')" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚úçÔ∏è</div>
                                                <div class="font-semibold text-sm mb-1">I'll do it manually</div>
                                                <div class="text-xs text-gray-600">You answer questions and set priorities</div>
                                              </button>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 5. Values, Mission & Vision',
                                        icon: 'üéØ',
                                        content: `
                                          <div class="mb-6">
                                            <p class="text-center text-gray-700 text-base mb-4">Here you will create:</p>
                                          </div>

                                          <!-- What You'll Create Section -->
                                          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-5 mb-6">
                                            <div class="space-y-3">
                                              <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-semibold text-sm mb-1">üìñ Family & Business History</div>
                                                <div class="text-xs text-gray-600">Where we came from, key milestones</div>
                                              </div>
                                              <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-semibold text-sm mb-1">üíé Family Values</div>
                                                <div class="text-xs text-gray-600">What matters to us as a family? Identifying core values</div>
                                              </div>
                                              <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-semibold text-sm mb-1">üéØ Family Mission</div>
                                                <div class="text-xs text-gray-600">Why are we together? What legacy do we want to leave?</div>
                                              </div>
                                              <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-semibold text-sm mb-1">üîÆ 10-Year Vision</div>
                                                <div class="text-xs text-gray-600">Where we want to be in 10 years ‚Äî as a family and business owners</div>
                                              </div>
                                              <div class="bg-white rounded-lg p-3 shadow-sm">
                                                <div class="font-semibold text-sm mb-1">‚öñÔ∏è Family Governance Structure</div>
                                                <div class="text-xs text-gray-600">Family Assembly, Family Council, Board of Directors connection</div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Output Section -->
                                          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-4 mb-6">
                                            <h4 class="font-bold text-sm mb-2 text-green-900">Output:</h4>
                                            <div class="text-xs text-gray-700 space-y-1">
                                              <div>‚úì Preamble</div>
                                              <div>‚úì Family Values & Mission</div>
                                              <div>‚úì Family Governance Structure</div>
                                            </div>
                                          </div>

                                          <!-- Workshop Method Selection -->
                                          <div class="mb-4">
                                            <h4 class="font-bold text-lg mb-4 text-center text-gray-900">Choose Workshop Format</h4>
                                            <div class="grid grid-cols-2 gap-3">
                                              <button onclick="selectWorkshopMethod('advisor', 5)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">üë®‚Äçüíº</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with an Advisor</div>
                                                <div class="text-xs text-gray-600">Professional expert helps identify key risks and growth points</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai', 5)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">ü§ñ</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with AI</div>
                                                <div class="text-xs text-gray-600">AI assistant guides the process, no in-person meetings</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai-auto', 5)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚ö°</div>
                                                <div class="font-semibold text-sm mb-1">Let AI do this step</div>
                                                <div class="text-xs text-gray-600">Upload data ‚Äî AI analyzes and delivers a ready report</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('manual', 5)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚úçÔ∏è</div>
                                                <div class="font-semibold text-sm mb-1">I'll do it manually</div>
                                                <div class="text-xs text-gray-600">You answer questions and set priorities</div>
                                              </button>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 6. Decision-Making & Conflict Management',
                                        icon: '‚öñÔ∏è',
                                        content: `
                                          <div class="mb-6">
                                            <p class="text-center text-gray-700 text-base mb-4">You will create:</p>
                                          </div>

                                          <!-- Key Rules & Policies Section -->
                                          <div class="mb-6">
                                            <h4 class="font-bold text-base mb-3 text-center text-gray-900">Key Rules & Policies</h4>
                                            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4 mb-4">
                                              <div class="space-y-2">
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üëî Working in Family Business</div>
                                                  <div class="text-xs text-gray-600">Required experience, education, compensation rules</div>
                                                </div>
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üíº Finance & Ownership</div>
                                                  <div class="text-xs text-gray-600">Share ownership, financial decisions, dividends</div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Conflicts & Conduct Section -->
                                          <div class="mb-6">
                                            <h4 class="font-bold text-base mb-3 text-center text-gray-900">Conflicts & Code of Conduct</h4>
                                            <div class="bg-gradient-to-br from-orange-50 to-amber-50 border-2 border-orange-200 rounded-lg p-4">
                                              <div class="space-y-2">
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">ü§ù Conflict Resolution Procedure</div>
                                                  <div class="text-xs text-gray-600">Step-by-step process for handling disagreements</div>
                                                </div>
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üìú Code of Conduct</div>
                                                  <div class="text-xs text-gray-600">Expected behavior and family standards</div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Output Section -->
                                          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-4 mb-6">
                                            <h4 class="font-bold text-sm mb-2 text-green-900">Output - Constitution Sections:</h4>
                                            <div class="grid grid-cols-2 gap-2 text-xs text-gray-700">
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Decision Making Process</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Conflict Resolution</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Voting Rules & Procedures</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Family Wealth Management</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Family Philanthropy</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Constitution Amendment Process</div>
                                            </div>
                                          </div>

                                          <!-- Workshop Method Selection -->
                                          <div class="mb-4">
                                            <h4 class="font-bold text-lg mb-4 text-center text-gray-900">Choose Workshop Format</h4>
                                            <div class="grid grid-cols-2 gap-3">
                                              <button onclick="selectWorkshopMethod('advisor', 6)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">üë®‚Äçüíº</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with an Advisor</div>
                                                <div class="text-xs text-gray-600">Professional expert helps identify key risks and growth points</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai', 6)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">ü§ñ</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with AI</div>
                                                <div class="text-xs text-gray-600">AI assistant guides the process, no in-person meetings</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai-auto', 6)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚ö°</div>
                                                <div class="font-semibold text-sm mb-1">Let AI do this step</div>
                                                <div class="text-xs text-gray-600">Upload data ‚Äî AI analyzes and delivers a ready report</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('manual', 6)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚úçÔ∏è</div>
                                                <div class="font-semibold text-sm mb-1">I'll do it manually</div>
                                                <div class="text-xs text-gray-600">You answer questions and set priorities</div>
                                              </button>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 7. Succession & Development',
                                        icon: 'üå±',
                                        content: `
                                          <div class="mb-6">
                                            <p class="text-center text-gray-700 text-base mb-4">You will create:</p>
                                          </div>

                                          <!-- Succession Section -->
                                          <div class="mb-6">
                                            <h4 class="font-bold text-base mb-3 text-center text-gray-900">Succession</h4>
                                            <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4 mb-4">
                                              <div class="space-y-2">
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üìÖ Transfer Plan</div>
                                                  <div class="text-xs text-gray-600">When and how to transfer business control to next generation</div>
                                                </div>
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">‚úÖ Successor Criteria</div>
                                                  <div class="text-xs text-gray-600">Required knowledge and skills for future CEO/owner</div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Next Generation Engagement Section -->
                                          <div class="mb-6">
                                            <h4 class="font-bold text-base mb-3 text-center text-gray-900">Next Generation Engagement</h4>
                                            <div class="bg-gradient-to-br from-purple-50 to-indigo-50 border-2 border-purple-200 rounded-lg p-4">
                                              <div class="space-y-2">
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üéì Education & Experience</div>
                                                  <div class="text-xs text-gray-600">Required training and practical experience programs</div>
                                                </div>
                                                <div class="bg-white rounded-lg p-3 shadow-sm">
                                                  <div class="font-semibold text-sm mb-1">üóìÔ∏è Timeline & Stages</div>
                                                  <div class="text-xs text-gray-600">Concrete plan for 3-5-10 years</div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Output Section -->
                                          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-4 mb-6">
                                            <h4 class="font-bold text-sm mb-2 text-green-900">Output - Constitution Sections:</h4>
                                            <div class="grid grid-cols-2 gap-2 text-xs text-gray-700">
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Succession Planning</div>
                                              <div class="bg-white rounded p-2 shadow-sm">‚úì Family Education & Development</div>
                                            </div>
                                          </div>

                                          <!-- Workshop Method Selection -->
                                          <div class="mb-4">
                                            <h4 class="font-bold text-lg mb-4 text-center text-gray-900">Choose Workshop Format</h4>
                                            <div class="grid grid-cols-2 gap-3">
                                              <button onclick="selectWorkshopMethod('advisor', 7)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">üë®‚Äçüíº</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with an Advisor</div>
                                                <div class="text-xs text-gray-600">Professional expert helps identify key risks and growth points</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai', 7)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">ü§ñ</div>
                                                <div class="font-semibold text-sm mb-1">Workshop with AI</div>
                                                <div class="text-xs text-gray-600">AI assistant guides the process, no in-person meetings</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('ai-auto', 7)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚ö°</div>
                                                <div class="font-semibold text-sm mb-1">Let AI do this step</div>
                                                <div class="text-xs text-gray-600">Upload data ‚Äî AI analyzes and delivers a ready report</div>
                                              </button>
                                              <button onclick="selectWorkshopMethod('manual', 7)" class="border-2 border-gray-300 rounded-lg p-4 bg-white hover:border-blue-500 hover:bg-blue-50 transition-all text-left">
                                                <div class="text-2xl mb-2">‚úçÔ∏è</div>
                                                <div class="font-semibold text-sm mb-1">I'll do it manually</div>
                                                <div class="text-xs text-gray-600">You answer questions and set priorities</div>
                                              </button>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Continue'
                                      },
                                      {
                                        title: 'Step 8. Finalization & Launch',
                                        icon: 'üéâ',
                                        content: `
                                          <div class="text-center mb-6">
                                            <div class="text-6xl mb-4">üéâ</div>
                                            <h3 class="text-2xl font-bold text-green-600 mb-3">Congratulations!</h3>
                                            <p class="text-lg text-gray-800 mb-2">Your Family Constitution is Ready!</p>
                                            <p class="text-sm text-gray-600">All sections have been completed and consolidated into your final document</p>
                                          </div>

                                          <!-- What's Next Section -->
                                          <div class="bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-300 rounded-lg p-6 mb-6">
                                            <h4 class="font-bold text-lg mb-4 text-center text-blue-900">What's Next?</h4>
                                            <div class="space-y-3">
                                              <div class="flex items-start space-x-3">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">1</div>
                                                <div>
                                                  <div class="font-semibold text-sm">Find Your Constitution</div>
                                                  <div class="text-xs text-gray-600">Navigate to <strong>Governance ‚Üí Constitution</strong> to view your complete document</div>
                                                </div>
                                              </div>
                                              <div class="flex items-start space-x-3">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">2</div>
                                                <div>
                                                  <div class="font-semibold text-sm">Share with Family</div>
                                                  <div class="text-xs text-gray-600">All family members can now access and review the constitution</div>
                                                </div>
                                              </div>
                                              <div class="flex items-start space-x-3">
                                                <div class="flex-shrink-0 w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center font-bold">3</div>
                                                <div>
                                                  <div class="font-semibold text-sm">Start Using the Platform</div>
                                                  <div class="text-xs text-gray-600">Explore all features: meetings, decisions, tasks, education, and more</div>
                                                </div>
                                              </div>
                                            </div>
                                          </div>

                                          <!-- Platform Features Section -->
                                          <div class="bg-gradient-to-br from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg p-5">
                                            <h4 class="font-bold text-base mb-3 text-center text-green-900">Full Platform Access Now Available</h4>
                                            <div class="grid grid-cols-2 gap-2 text-xs">
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">üìÖ Family Meetings</div>
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">‚öñÔ∏è Decision Making</div>
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">‚úÖ Task Management</div>
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">üéì Education Programs</div>
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">üí¨ Family Communication</div>
                                              <div class="bg-white rounded-lg p-2 shadow-sm text-center">ü§ù Conflict Resolution</div>
                                            </div>
                                          </div>
                                        `,
                                        cta: 'Go to Dashboard'
                                      }
                                    ];

                                    let completedSteps = [0]; // Array of completed step indices (Step 1 always completed)
                                    let selectedStepIndex = 1; // Currently selected step for viewing

                                    // Step titles for horizontal boxes
                                    const stepTitles = [
                                      'Profile',
                                      'Members',
                                      'Why',
                                      'Assessment',
                                      'Values',
                                      'Decisions',
                                      'Succession',
                                      'Launch'
                                    ];

                                    function renderHorizontalSteps() {
                                      const container = document.getElementById('horizontalStepsContainer');
                                      container.innerHTML = '';

                                      stepsData.forEach((step, idx) => {
                                        const isCompleted = completedSteps.includes(idx);
                                        const isSelected = idx === selectedStepIndex;

                                        const stepBox = document.createElement('div');
                                        stepBox.className = `
                                          flex flex-col items-center justify-center w-36 h-36 rounded-xl cursor-pointer transition-all duration-200 shadow-md
                                          ${isCompleted ? 'bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-500 hover:shadow-lg' :
                                            'bg-gradient-to-br from-gray-50 to-gray-100 border-2 border-gray-300 hover:shadow-lg'}
                                          ${isSelected ? 'ring-4 ring-blue-400 scale-105 shadow-xl' : 'hover:scale-105'}
                                        `;

                                        stepBox.onclick = () => selectStep(idx);

                                        stepBox.innerHTML = `
                                          <div class="text-5xl mb-2">${step.icon}</div>
                                          <div class="text-sm font-bold text-center px-2 ${isCompleted ? 'text-green-800' : 'text-gray-600'}">${stepTitles[idx]}</div>
                                          ${isCompleted ? '<div class="text-green-600 text-2xl font-bold mt-1">‚úì</div>' : ''}
                                        `;

                                        container.appendChild(stepBox);
                                      });
                                    }

                                    function selectStep(idx) {
                                      selectedStepIndex = idx;
                                      renderHorizontalSteps();
                                      renderExpandedContent();
                                    }

                                    function renderExpandedContent() {
                                      const contentArea = document.getElementById('expandedStepContent');
                                      const step = stepsData[selectedStepIndex];
                                      const isCompleted = completedSteps.includes(selectedStepIndex);

                                      // Special content for completed Step 2
                                      let contentToShow = step.content;
                                      if (selectedStepIndex === 1 && isCompleted) {
                                        contentToShow = `<div class="mb-4">You've taken a big step! While we wait for other family members to register, we can move forward.</div>
                                        <div class="text-sm text-gray-600">5 of 8 members registered</div>`;
                                      }

                                      contentArea.innerHTML = `
                                        <div class="bg-white rounded-lg border-2 ${isCompleted ? 'border-green-400 bg-green-50' : 'border-blue-400 bg-blue-50'} p-8 shadow-lg animate-fadeIn">
                                          <div class="flex items-center mb-6">
                                            <span class="text-4xl mr-3">${step.icon}</span>
                                            <h2 class="text-3xl font-bold">${step.title}</h2>
                                            ${isCompleted ? '<span class="text-green-600 text-3xl ml-3">‚úì</span>' : ''}
                                          </div>
                                          <div class="mb-8 text-base">${contentToShow}</div>
                                          ${!isCompleted ? `
                                            <div class="flex justify-between items-center space-x-4 pt-4 border-t">
                                              ${step.extra || '<span></span>'}
                                              <button onclick="completeStep(${selectedStepIndex})" class="bg-blue-600 text-white px-8 py-3 rounded-lg hover:bg-blue-700 transition-colors ml-auto font-medium text-lg shadow-md hover:shadow-lg">
                                                ${step.cta} ‚Üí
                                              </button>
                                            </div>
                                          ` : `
                                            <div class="bg-green-100 border border-green-300 rounded-lg p-4 text-center">
                                              <span class="text-green-700 font-medium">‚úì This step is completed</span>
                                            </div>
                                          `}
                                        </div>
                                      `;
                                    }

                                    function renderAllSteps() {
                                      renderHorizontalSteps();
                                      renderExpandedContent();

                                      // Update progress bar based on completed steps count
                                      const completedCount = completedSteps.length;
                                      const progressPercent = Math.round((completedCount / stepsData.length) * 100);

                                      document.getElementById('progressBar').style.width = progressPercent + '%';
                                      document.getElementById('completedSteps').textContent = completedCount;

                                      // Update dashboard progress card (right side)
                                      const dashboardPercent = document.getElementById('dashboardProgressPercent');
                                      const dashboardStatus = document.getElementById('dashboardProgressStatus');

                                      if (dashboardPercent && dashboardStatus) {
                                        dashboardPercent.textContent = progressPercent + '%';

                                        // Update status text based on progress
                                        if (completedCount === 0) {
                                          dashboardStatus.textContent = 'Not started';
                                        } else if (completedCount === stepsData.length) {
                                          dashboardStatus.textContent = 'Completed';
                                        } else {
                                          dashboardStatus.textContent = `${completedCount} of ${stepsData.length} steps completed`;
                                        }
                                      }

                                      // Update dashboard horizontal progress steps
                                      updateDashboardProgressSteps();
                                    }

                                    function completeStep(idx) {
                                      // Add step to completed array if not already there
                                      if (!completedSteps.includes(idx)) {
                                        completedSteps.push(idx);
                                      }

                                      // If this is the last step, finish onboarding
                                      if (idx === stepsData.length - 1) {
                                        finishOnboarding();
                                        return;
                                      }

                                      // Find next uncompleted step to select
                                      let nextStep = idx + 1;
                                      while (nextStep < stepsData.length && completedSteps.includes(nextStep)) {
                                        nextStep++;
                                      }

                                      // If all steps completed, stay on current step
                                      if (nextStep >= stepsData.length) {
                                        nextStep = idx;
                                      }

                                      selectedStepIndex = nextStep;
                                      renderAllSteps();
                                    }

                                    function openOnboardingModal() {
                                      document.getElementById('onboardingModal').classList.remove('hidden');
                                      completedSteps = [0]; // Step 1 (index 0) always completed
                                      selectedStepIndex = 1; // Start with step 2 selected (Members)
                                      renderAllSteps();
                                    }

                                    // Update dashboard horizontal progress steps visualization
                                    function updateDashboardProgressSteps() {
                                      for (let i = 1; i <= 8; i++) {
                                        const stepCircle = document.getElementById(`progressStep${i}`);
                                        const stepLine = document.getElementById(`progressLine${i}`);

                                        if (!stepCircle) continue;

                                        const stepIndex = i - 1; // 0-based index
                                        const isCompleted = completedSteps.includes(stepIndex);

                                        if (isCompleted) {
                                          // Completed step - green with checkmark
                                          stepCircle.className = 'w-12 h-12 rounded-full bg-green-500 flex items-center justify-center text-white font-bold shadow-lg';
                                          stepCircle.innerHTML = '<span class="text-xl">‚úì</span>';
                                        } else {
                                          // Incomplete step - gray
                                          stepCircle.className = 'w-12 h-12 rounded-full bg-gray-300 flex items-center justify-center text-gray-500 font-bold shadow';
                                          stepCircle.innerHTML = `<span class="text-lg">${i}</span>`;
                                        }

                                        // Update connecting line
                                        if (stepLine) {
                                          if (isCompleted && completedSteps.includes(stepIndex + 1)) {
                                            stepLine.className = 'flex-1 h-1 bg-green-500 mx-2'; // Green line if both sides complete
                                          } else {
                                            stepLine.className = 'flex-1 h-1 bg-gray-300 mx-2'; // Gray line otherwise
                                          }
                                        }
                                      }
                                    }

                                    // Initialize dashboard progress on page load
                                    function initializeDashboardProgress() {
                                      const completedCount = completedSteps.length;
                                      const progressPercent = Math.round((completedCount / stepsData.length) * 100);

                                      const dashboardPercent = document.getElementById('dashboardProgressPercent');
                                      const dashboardStatus = document.getElementById('dashboardProgressStatus');

                                      if (dashboardPercent && dashboardStatus) {
                                        dashboardPercent.textContent = progressPercent + '%';

                                        if (completedCount === 0) {
                                          dashboardStatus.textContent = 'Not started';
                                        } else if (completedCount === stepsData.length) {
                                          dashboardStatus.textContent = 'Completed';
                                        } else {
                                          dashboardStatus.textContent = `${completedCount} of ${stepsData.length} steps completed`;
                                        }
                                      }

                                      // Also update horizontal progress steps
                                      updateDashboardProgressSteps();
                                    }

                                    // Call initialization when page loads
                                    document.addEventListener('DOMContentLoaded', initializeDashboardProgress);

                                    function closeOnboardingModal() {
                                      document.getElementById('onboardingModal').classList.add('hidden');
                                    }

                                    function goToInviteFlow() {
                                      closeOnboardingModal();
                                      window.location.href = '02-family-members.html';
                                    }

                                    function selectAssessmentMethod(method) {
                                      // Save selected method to localStorage for later use
                                      localStorage.setItem('selectedAssessmentMethod', method);

                                      // Redirect to workshop overview page
                                      window.location.href = '../onboarding-flow/values-workshop/01-workshop-overview.html';
                                    }

                                    function selectWorkshopMethod(method, stepNumber) {
                                      // Save selected method and step to localStorage
                                      localStorage.setItem(`workshop_step${stepNumber}_method`, method);

                                      // For now, just complete the step and continue
                                      // In real implementation, this would redirect to workshop page
                                      completeStep(stepNumber - 1);

                                      // Show confirmation
                                      console.log(`Selected ${method} for step ${stepNumber}`);
                                    }

                                    function finishOnboarding() {
                                      alert('Your Family Constitution is ready! The onboarding process is complete.');
                                      closeOnboardingModal();
                                    }
                                    </script>
                                </div>
                            </div>
                        </div>

        <!-- Constitution Setup Banner - In Progress State (Hidden by default, toggle with JS) -->
        <div id="inProgressBanner" class="bg-amber-50 border-2 border-amber-200 rounded-lg p-6 mb-6 hidden">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <div class="flex items-center mb-2">
                        <span class="text-2xl mr-2">üìú</span>
                        <h3 class="text-xl font-bold text-amber-900">Constitution Setup In Progress</h3>
                        <span class="ml-3 px-3 py-1 bg-amber-100 text-amber-800 text-xs font-medium rounded-full">Step 5 of 8</span>
                    </div>
                    <p class="text-amber-800 mb-1"><strong>Domain:</strong> Conflict Resolution</p>
                    <p class="text-amber-700 mb-4">You're currently at: Survey Collection - waiting for all participants to complete their responses.</p>

                    <!-- Progress Bar -->
                    <div class="mb-4">
                        <div class="flex justify-between text-sm text-amber-700 mb-1">
                            <span>Progress</span>
                            <span>62.5%</span>
                        </div>
                        <div class="w-full bg-amber-100 rounded-full h-2">
                            <div class="bg-amber-600 h-2 rounded-full" style="width: 62.5%"></div>
                        </div>
                    </div>

                    <div class="flex items-center space-x-4">
                        <button onclick="window.location.href='04-onboarding-wizard.html'" class="bg-amber-600 text-white px-6 py-2 rounded-lg hover:bg-amber-700 transition-colors font-medium">
                            Continue Setup ‚Üí
                        </button>
                        <button class="text-amber-700 hover:text-amber-900 font-medium">Start Over</button>
                    </div>
                </div>
                <div class="ml-6">
                    <div class="bg-white rounded-lg p-4 border border-amber-200">
                        <div class="text-sm text-gray-600 mb-2">Completed</div>
                        <div class="text-3xl font-bold text-amber-600">5/8</div>
                        <div class="text-xs text-gray-500 mt-1">Steps</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toggle Buttons for Demo -->
        <div class="mb-6 flex items-center space-x-2">
            <button onclick="toggleFamilyMembersAlert()" class="text-xs bg-purple-200 px-3 py-1 rounded text-purple-700 hover:bg-purple-300">
                Toggle: Family Members Alert (Demo)
            </button>
            <button onclick="toggleBannerState()" class="text-xs bg-gray-200 px-3 py-1 rounded text-gray-700 hover:bg-gray-300">
                Toggle: Constitution Not Started ‚ÜîÔ∏è In Progress (Demo)
            </button>
        </div>

        <!-- Family Overview -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-lg font-bold mb-4">Family Overview</h2>
            <div class="grid grid-cols-4 gap-4">
                <div class="bg-orange-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <span class="text-orange-500 text-2xl mr-2">üë•</span>
                        <div>
                            <div class="text-2xl font-bold">2</div>
                            <div class="text-sm text-gray-600">Family Members</div>
                        </div>
                    </div>
                    <a href="#" class="text-orange-500 text-sm hover:underline">See More ‚Ä∫</a>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <span class="text-orange-500 text-2xl mr-2">üìÖ</span>
                        <div>
                            <div class="text-2xl font-bold">0</div>
                            <div class="text-sm text-gray-600">Upcoming Meetings</div>
                        </div>
                    </div>
                    <a href="#" class="text-orange-500 text-sm hover:underline">See More ‚Ä∫</a>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <span class="text-orange-500 text-2xl mr-2">‚öñÔ∏è</span>
                        <div>
                            <div class="text-2xl font-bold">0</div>
                            <div class="text-sm text-gray-600">Pending Decisions</div>
                        </div>
                    </div>
                    <a href="#" class="text-orange-500 text-sm hover:underline">See More ‚Ä∫</a>
                </div>
                <div class="bg-orange-50 p-4 rounded-lg">
                    <div class="flex items-center mb-2">
                        <span class="text-orange-500 text-2xl mr-2">üéì</span>
                        <div>
                            <div class="text-2xl font-bold">0</div>
                            <div class="text-sm text-gray-600">Education Modules</div>
                        </div>
                    </div>
                    <a href="#" class="text-orange-500 text-sm hover:underline">See More ‚Ä∫</a>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="bg-white rounded-lg shadow p-6 mb-6">
            <h2 class="text-lg font-bold mb-4">Quick Actions</h2>
            <div class="grid grid-cols-4 gap-4">
                <a href="#" class="bg-gray-50 p-4 rounded-lg text-center hover:bg-gray-100 transition-colors">
                    <div class="text-orange-500 text-3xl mb-2">üìÑ</div>
                    <div class="font-medium">Constitution</div>
                    <div class="text-sm text-orange-500">See More ‚Ä∫</div>
                </a>
                <a href="#" class="bg-gray-50 p-4 rounded-lg text-center hover:bg-gray-100 transition-colors">
                    <div class="text-orange-500 text-3xl mb-2">üë®‚Äçüë©‚Äçüëß‚Äçüë¶</div>
                    <div class="font-medium">Family Council</div>
                    <div class="text-sm text-orange-500">See More ‚Ä∫</div>
                </a>
                <a href="#" class="bg-gray-50 p-4 rounded-lg text-center hover:bg-gray-100 transition-colors">
                    <div class="text-orange-500 text-3xl mb-2">‚öñÔ∏è</div>
                    <div class="font-medium">Decisions</div>
                    <div class="text-sm text-orange-500">See More ‚Ä∫</div>
                </a>
                <a href="#" class="bg-gray-50 p-4 rounded-lg text-center hover:bg-gray-100 transition-colors">
                    <div class="text-orange-500 text-3xl mb-2">üéì</div>
                    <div class="font-medium">Education</div>
                    <div class="text-sm text-orange-500">See More ‚Ä∫</div>
                </a>
            </div>
        </div>

        <!-- Two Column Layout -->
        <div class="grid grid-cols-2 gap-6">
            <!-- Upcoming Meetings -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold">Upcoming Meetings</h2>
                    <a href="#" class="text-orange-500 text-sm hover:underline">View All ‚Ä∫</a>
                </div>
                <div class="text-center py-8">
                    <div class="text-gray-400 text-4xl mb-2">üìÖ</div>
                    <div class="font-medium">No upcoming meetings scheduled</div>
                    <button class="mt-4 text-orange-500 hover:underline">Schedule a Meeting</button>
                </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-white rounded-lg shadow p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-bold">Recent Activity</h2>
                    <a href="#" class="text-orange-500 text-sm hover:underline">View All ‚Ä∫</a>
                </div>
                <div class="text-center py-8">
                    <div class="text-gray-400 text-4xl mb-2">üìù</div>
                    <div class="font-medium">No recent activity</div>
                    <div class="text-sm text-gray-500 mt-1">Family activities will appear here as they happen</div>
                </div>
            </div>
        </div>

        <!-- My Tasks -->
        <div class="bg-white rounded-lg shadow p-6 mt-6">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-lg font-bold">My Tasks (2)</h2>
                <a href="#" class="text-orange-500 text-sm hover:underline">View All ‚Ä∫</a>
            </div>
            <div class="space-y-3">
                <div class="flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50">
                    <div class="flex items-center">
                        <input type="checkbox" class="mr-3">
                        <div>
                            <div class="font-medium">Address conflict: How to use the profits from the family business this...</div>
                            <div class="text-sm text-gray-500">Conflict</div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <span class="px-3 py-1 bg-orange-100 text-orange-800 text-sm rounded mr-3">Action Required</span>
                        <button class="text-gray-400 hover:text-gray-600">‚Ä∫</button>
                    </div>
                </div>
                <div class="flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50">
                    <div class="flex items-center">
                        <input type="checkbox" class="mr-3">
                        <div>
                            <div class="font-medium">Complete monthly family governance review</div>
                            <div class="text-sm text-gray-500">Governance ¬∑ Due Oct 15, 2025</div>
                        </div>
                    </div>
                    <div class="flex items-center">
                        <span class="px-3 py-1 bg-yellow-100 text-yellow-800 text-sm rounded mr-3">Due Soon</span>
                        <button class="text-gray-400 hover:text-gray-600">‚Ä∫</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentState = 'notStarted';
        let familyMembersVisible = false;

        function resendInvites(event) {
            // Show confirmation message
            const confirmed = confirm('üìß Resend invitation reminders to 3 members who haven\'t registered yet?\n\nPending invitations:\n‚Ä¢ John Doe (john@example.com)\n‚Ä¢ Jane Smith (jane@example.com)\n‚Ä¢ Robert Johnson (robert@example.com)');

            if (confirmed) {
                // In real implementation, this would call the API
                // For demo, just show success message with loading simulation
                const button = event.target.closest('button');
                const originalHTML = button.innerHTML;

                button.disabled = true;
                button.classList.add('pointer-events-none');
                button.innerHTML = `
                    <svg class="w-4 h-4 animate-spin inline-block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                    </svg>
                    <span class="ml-2">Sending...</span>
                `;

                setTimeout(() => {
                    button.disabled = false;
                    button.classList.remove('pointer-events-none');
                    button.innerHTML = originalHTML;
                    alert('‚úì Invitation reminders sent successfully!\n\n3 reminders have been delivered to:\n‚Ä¢ John Doe (john@example.com)\n‚Ä¢ Jane Smith (jane@example.com)\n‚Ä¢ Robert Johnson (robert@example.com)\n\nThey will receive email notifications shortly.');
                }, 1500);
            }
        }

        function toggleFamilyMembersAlert() {
            const familyAlert = document.getElementById('familyMembersAlert');
            const constitutionBanner = document.getElementById('constitutionBanner');
            const inProgressBanner = document.getElementById('inProgressBanner');

            if (familyMembersVisible) {
                familyAlert.classList.add('hidden');
                familyMembersVisible = false;
            } else {
                familyAlert.classList.remove('hidden');
                // Hide constitution banners when family setup is needed
                constitutionBanner.classList.add('hidden');
                inProgressBanner.classList.add('hidden');
                familyMembersVisible = true;
            }
        }

        function toggleBannerState() {
            const notStarted = document.getElementById('constitutionBanner');
            const inProgress = document.getElementById('inProgressBanner');

            // Don't toggle if family members alert is visible
            if (familyMembersVisible) {
                return;
            }

            if (currentState === 'notStarted') {
                notStarted.classList.add('hidden');
                inProgress.classList.remove('hidden');
                currentState = 'inProgress';
            } else {
                notStarted.classList.remove('hidden');
                inProgress.classList.add('hidden');
                currentState = 'notStarted';
            }
        }
    </script>
</body>
</html>