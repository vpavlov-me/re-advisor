<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Question - Family Governance Assessment</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/screens.css">
</head>
<body>
    <div class="screen-container">
        <header class="screen-header">
            <div class="logo">ReFamily</div>
            <div class="header-actions">
                <div class="auto-save-indicator">üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ 2 –º–∏–Ω—É—Ç—ã –Ω–∞–∑–∞–¥</div>
                <div class="user-menu">
                    <span class="user-name">–í–ª–∞–¥–∏—Å–ª–∞–≤</span>
                    <span class="user-avatar">–í</span>
                </div>
            </div>
        </header>

        <main class="screen-content">
            <div class="question-screen">
                <!-- Progress Bar -->
                <div class="question-progress-bar">
                    <div class="progress-fill" id="questionProgressFill" style="width: 62%"></div>
                </div>
                <div class="progress-text" id="progressText">–í–æ–ø—Ä–æ—Å 3 –∏–∑ 13 –≤ —ç—Ç–æ–º –∏–∑–º–µ—Ä–µ–Ω–∏–∏ ‚Ä¢ 65 –∏–∑ 105 –≤—Å–µ–≥–æ</div>

                <!-- Dimension Badge -->
                <div class="dimension-badge-small" id="dimBadge">
                    <span class="badge-icon" id="badgeIcon">üë•</span>
                    <span class="badge-text" id="badgeText">–†–∞–∑–≤–∏—Ç–∏–µ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è</span>
                </div>

                <!-- Question Content -->
                <div class="question-content">
                    <h2 class="question-title" id="questionTitle">
                        –ù–∞—Å–∫–æ–ª—å–∫–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è?
                    </h2>

                    <p class="question-help-text" id="questionHelpText">
                        –û—Ü–µ–Ω–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∏ —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤ (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ, —Å–µ–º–∏–Ω–∞—Ä—ã).
                    </p>

                    <!-- Question Type Container (dynamically rendered) -->
                    <div class="question-answer-area" id="answerArea">
                        <!-- Likert Scale (default example) -->
                        <div class="likert-scale" id="likertScale">
                            <div class="likert-labels">
                                <span class="likert-label-start">–ù–∏–∫–æ–≥–¥–∞</span>
                                <span class="likert-label-end">–†–µ–≥—É–ª—è—Ä–Ω–æ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ</span>
                            </div>
                            <div class="likert-options">
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="1">
                                    <span class="likert-number">1</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="2">
                                    <span class="likert-number">2</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="3">
                                    <span class="likert-number">3</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="4">
                                    <span class="likert-number">4</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="5">
                                    <span class="likert-number">5</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="6">
                                    <span class="likert-number">6</span>
                                </label>
                                <label class="likert-option">
                                    <input type="radio" name="answer" value="7">
                                    <span class="likert-number">7</span>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Comment Section -->
                    <div class="question-comment-section">
                        <label for="questionComment" class="comment-label">
                            üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
                        </label>
                        <textarea
                            id="questionComment"
                            class="comment-textarea"
                            placeholder="–î–æ–±–∞–≤—å—Ç–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç, –ø—Ä–∏–º–µ—Ä—ã –∏–ª–∏ –ø–æ—è—Å–Ω–µ–Ω–∏—è –∫ –≤–∞—à–µ–º—É –æ—Ç–≤–µ—Ç—É..."
                            rows="3"
                        ></textarea>
                        <div class="comment-privacy-note">
                            –í–∏–¥–µ–Ω: <span id="commentVisibility">–í—Å–µ–º —á–ª–µ–Ω–∞–º —Å–µ–º—å–∏</span>
                        </div>
                    </div>

                    <!-- Why This Matters -->
                    <div class="why-matters-box">
                        <div class="why-icon">üí°</div>
                        <div class="why-content">
                            <h4>–ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ?</h4>
                            <p id="whyMatters">
                                –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ–∫–æ–ª–µ–Ω–∏—é —Ä–∞–∑–≤–∏–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ
                                –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–º–µ–π–Ω—ã–º –±–æ–≥–∞—Ç—Å—Ç–≤–æ–º –∏ –±–∏–∑–Ω–µ—Å–æ–º.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <div class="screen-navigation">
            <button onclick="previousQuestion()" class="btn-secondary" id="prevBtn">
                ‚Üê –ü—Ä–µ–¥—ã–¥—É—â–∏–π
            </button>
            <div class="nav-progress">
                <span class="nav-label" id="navLabel">–ò–∑–º–µ—Ä–µ–Ω–∏–µ 3</span>
                <span class="nav-step" id="navStep">–í–æ–ø—Ä–æ—Å 3 / 13</span>
            </div>
            <button onclick="nextQuestion()" class="btn-primary" id="nextBtn" disabled>
                –°–ª–µ–¥—É—é—â–∏–π ‚Üí
            </button>
        </div>
    </div>

    <style>
        .question-screen {
            max-width: 800px;
            margin: 0 auto;
        }

        .question-progress-bar {
            width: 100%;
            height: 8px;
            background: var(--gray-200);
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 8px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--success));
            transition: width 0.5s ease;
        }

        .progress-text {
            font-size: 14px;
            color: var(--gray-600);
            text-align: center;
            margin-bottom: 24px;
        }

        .dimension-badge-small {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--primary-light);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 24px;
        }

        .badge-icon {
            font-size: 18px;
        }

        .question-content {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 40px;
        }

        .question-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--gray-900);
            margin-bottom: 16px;
            line-height: 1.4;
        }

        .question-help-text {
            font-size: 16px;
            color: var(--gray-600);
            margin-bottom: 32px;
            line-height: 1.6;
        }

        .question-answer-area {
            margin-bottom: 32px;
        }

        /* Likert Scale */
        .likert-scale {
            padding: 24px 0;
        }

        .likert-labels {
            display: flex;
            justify-content: space-between;
            margin-bottom: 16px;
            font-size: 14px;
            color: var(--gray-700);
            font-weight: 500;
        }

        .likert-options {
            display: flex;
            justify-content: space-between;
            gap: 12px;
        }

        .likert-option {
            flex: 1;
            position: relative;
            cursor: pointer;
        }

        .likert-option input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
            z-index: 1;
        }

        .likert-number {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            aspect-ratio: 1;
            border: 2px solid var(--gray-300);
            border-radius: 50%;
            font-size: 18px;
            font-weight: 600;
            color: var(--gray-700);
            background: white;
            transition: all 0.2s ease;
        }

        .likert-option:hover .likert-number {
            border-color: var(--primary);
            background: var(--primary-light);
        }

        .likert-option input[type="radio"]:checked ~ .likert-number {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
            transform: scale(1.1);
        }

        /* Comment Section */
        .question-comment-section {
            border-top: 1px solid var(--gray-200);
            padding-top: 24px;
            margin-bottom: 24px;
        }

        .comment-label {
            display: block;
            font-weight: 500;
            color: var(--gray-900);
            margin-bottom: 8px;
        }

        .comment-textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--gray-300);
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.2s ease;
        }

        .comment-textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px var(--primary-light);
        }

        .comment-privacy-note {
            font-size: 12px;
            color: var(--gray-600);
            margin-top: 8px;
        }

        /* Why Matters Box */
        .why-matters-box {
            background: var(--primary-light);
            border-left: 4px solid var(--primary);
            border-radius: 8px;
            padding: 20px;
            display: flex;
            gap: 16px;
        }

        .why-icon {
            font-size: 28px;
            flex-shrink: 0;
        }

        .why-content h4 {
            margin-bottom: 8px;
            color: var(--gray-900);
        }

        .why-content p {
            margin: 0;
            color: var(--gray-800);
            line-height: 1.6;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .question-content {
                padding: 24px;
            }

            .question-title {
                font-size: 20px;
            }

            .likert-options {
                gap: 6px;
            }

            .likert-number {
                font-size: 16px;
            }

            .likert-labels {
                font-size: 12px;
            }
        }
    </style>

    <script src="../js/prototype.js"></script>
    <script>
        // Get parameters from URL
        const dimId = getQueryParam('dim') || '3';
        const questionNum = parseInt(getQueryParam('q') || '1');
        const dimension = getDimension(dimId);

        // Sample questions for dimension 3 (Next Generation Development)
        const questions = [
            {
                id: 1,
                title: "–ù–∞—Å–∫–æ–ª—å–∫–æ –æ—Ç–∫—Ä—ã—Ç–æ —Å–µ–º—å—è –æ–±—Å—É–∂–¥–∞–µ—Ç –ø–ª–∞–Ω—ã –ø—Ä–µ–µ–º—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ —Å –º–ª–∞–¥—à–∏–º –ø–æ–∫–æ–ª–µ–Ω–∏–µ–º?",
                helpText: "–û—Ü–µ–Ω–∏—Ç–µ —Å—Ç–µ–ø–µ–Ω—å –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –±—É–¥—É—â–µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.",
                type: "likert7",
                labels: ["–ù–µ –æ–±—Å—É–∂–¥–∞–µ–º", "–û—Ç–∫—Ä—ã—Ç–æ –∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ"],
                whyMatters: "–û—Ç–∫—Ä—ã—Ç–æ–µ –æ–±—Å—É–∂–¥–µ–Ω–∏–µ –ø—Ä–µ–µ–º—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–º–æ–≥–∞–µ—Ç –º–ª–∞–¥—à–µ–º—É –ø–æ–∫–æ–ª–µ–Ω–∏—é –ø–æ–Ω–∏–º–∞—Ç—å —Å–≤–æ–∏ –±—É–¥—É—â–∏–µ —Ä–æ–ª–∏ –∏ –≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ –Ω–∏–º."
            },
            {
                id: 2,
                title: "–°—É—â–µ—Å—Ç–≤—É—é—Ç –ª–∏ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è?",
                helpText: "–í–∫–ª—é—á–∞—è –∫—É—Ä—Å—ã –ø–æ —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –≥—Ä–∞–º–æ—Ç–Ω–æ—Å—Ç–∏, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é –±–∏–∑–Ω–µ—Å–æ–º, —Å–µ–º–µ–π–Ω—ã–º —Ü–µ–Ω–Ω–æ—Å—Ç—è–º.",
                type: "likert7",
                labels: ["–ù–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º", "–ï—Å—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã"],
                whyMatters: "–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è."
            },
            {
                id: 3,
                title: "–ù–∞—Å–∫–æ–ª—å–∫–æ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–æ–¥—è—Ç—Å—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è?",
                helpText: "–û—Ü–µ–Ω–∏—Ç–µ —á–∞—Å—Ç–æ—Ç—É –∏ —Å–∏—Å—Ç–µ–º–Ω–æ—Å—Ç—å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤ (—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ, –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ, —Å–µ–º–∏–Ω–∞—Ä—ã).",
                type: "likert7",
                labels: ["–ù–∏–∫–æ–≥–¥–∞", "–†–µ–≥—É–ª—è—Ä–Ω–æ –∏ —Å–∏—Å—Ç–µ–º–Ω–æ"],
                whyMatters: "–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç —Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ–∫–æ–ª–µ–Ω–∏—é —Ä–∞–∑–≤–∏–≤–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ –¥–ª—è –±—É–¥—É—â–µ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–µ–º–µ–π–Ω—ã–º –±–æ–≥–∞—Ç—Å—Ç–≤–æ–º –∏ –±–∏–∑–Ω–µ—Å–æ–º."
            },
            {
                id: 4,
                title: "–ï—Å—Ç—å –ª–∏ —Å–∏—Å—Ç–µ–º–∞ –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–∞ –º–µ–∂–¥—É –ø–æ–∫–æ–ª–µ–Ω–∏—è–º–∏?",
                helpText: "–ù–∞–ª–∏—á–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∏–ª–∏ –Ω–µ—Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –Ω–∞—Å—Ç–∞–≤–Ω–∏—á–µ—Å—Ç–≤–∞ –æ—Ç —Å—Ç–∞—Ä—à–∏—Ö –∫ –º–ª–∞–¥—à–∏–º.",
                type: "likert7",
                labels: ["–ù–µ—Ç –º–µ–Ω—Ç–æ—Ä—Å—Ç–≤–∞", "–ï—Å—Ç—å –∞–∫—Ç–∏–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"],
                whyMatters: "–ú–µ–Ω—Ç–æ—Ä—Å—Ç–≤–æ –ø–µ—Ä–µ–¥–∞—ë—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –∑–Ω–∞–Ω–∏—è, –Ω–æ –∏ —Ü–µ–Ω–Ω–æ—Å—Ç–∏, –∫—É–ª—å—Ç—É—Ä—É –∏ –æ–ø—ã—Ç –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π."
            },
            {
                id: 5,
                title: "–ù–∞—Å–∫–æ–ª—å–∫–æ –º–ª–∞–¥—à–µ–µ –ø–æ–∫–æ–ª–µ–Ω–∏–µ –≤–æ–≤–ª–µ—á–µ–Ω–æ –≤ –ø—Ä–∏–Ω—è—Ç–∏–µ —Å–µ–º–µ–π–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π?",
                helpText: "–°—Ç–µ–ø–µ–Ω—å —É—á–∞—Å—Ç–∏—è G2/G3 –≤ –æ–±—Å—É–∂–¥–µ–Ω–∏—è—Ö –∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–∏ –ø–æ –≤–∞–∂–Ω—ã–º –≤–æ–ø—Ä–æ—Å–∞–º.",
                type: "likert7",
                labels: ["–ù–µ –≤–æ–≤–ª–µ—á–µ–Ω–æ", "–ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–æ–≤–ª–µ—á–µ–Ω–æ"],
                whyMatters: "–£—á–∞—Å—Ç–∏–µ –≤ —Ä–µ—à–µ–Ω–∏—è—Ö —Ä–∞–∑–≤–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∏ –ø–æ–¥–≥–æ—Ç–∞–≤–ª–∏–≤–∞–µ—Ç –∫ –±—É–¥—É—â–µ–π —Ä–æ–ª–∏."
            }
        ];

        // Current question
        const currentQ = questions[questionNum - 1] || questions[0];
        const totalQuestions = dimension ? dimension.questions : 13;

        // Update page content
        if (dimension) {
            document.getElementById('dimBadge').style.backgroundColor = dimension.color + '20';
            document.getElementById('dimBadge').style.color = dimension.color;
            document.getElementById('badgeIcon').textContent = dimension.icon;
            document.getElementById('badgeText').textContent = dimension.name;
        }

        document.getElementById('questionTitle').textContent = currentQ.title;
        document.getElementById('questionHelpText').textContent = currentQ.helpText;
        document.getElementById('whyMatters').textContent = currentQ.whyMatters;

        // Update progress
        const overallProgress = Math.round(((parseInt(dimId) - 1) * 13 + questionNum) / 105 * 100);
        document.getElementById('questionProgressFill').style.width = overallProgress + '%';
        document.getElementById('progressText').textContent =
            `–í–æ–ø—Ä–æ—Å ${questionNum} –∏–∑ ${totalQuestions} –≤ —ç—Ç–æ–º –∏–∑–º–µ—Ä–µ–Ω–∏–∏ ‚Ä¢ ${(parseInt(dimId) - 1) * 13 + questionNum} –∏–∑ 105 –≤—Å–µ–≥–æ`;

        document.getElementById('navLabel').textContent = `–ò–∑–º–µ—Ä–µ–Ω–∏–µ ${dimId}`;
        document.getElementById('navStep').textContent = `–í–æ–ø—Ä–æ—Å ${questionNum} / ${totalQuestions}`;

        // Check if this is first question
        if (questionNum === 1) {
            document.getElementById('prevBtn').disabled = true;
        }

        // Load saved answer if exists
        const savedAnswers = JSON.parse(sessionStorage.getItem('answers') || '{}');
        const answerKey = `${dimId}_${questionNum}`;
        if (savedAnswers[answerKey]) {
            const saved = savedAnswers[answerKey];
            const radio = document.querySelector(`input[name="answer"][value="${saved.value}"]`);
            if (radio) {
                radio.checked = true;
                document.getElementById('nextBtn').disabled = false;
            }
            if (saved.comment) {
                document.getElementById('questionComment').value = saved.comment;
            }
        }

        // Enable next button when answer is selected
        document.querySelectorAll('input[name="answer"]').forEach(radio => {
            radio.addEventListener('change', () => {
                document.getElementById('nextBtn').disabled = false;
                saveAnswer();
            });
        });

        // Auto-save comment
        document.getElementById('questionComment').addEventListener('input', () => {
            if (document.querySelector('input[name="answer"]:checked')) {
                saveAnswer();
            }
        });

        function saveAnswer() {
            const selectedRadio = document.querySelector('input[name="answer"]:checked');
            if (!selectedRadio) return;

            const value = parseInt(selectedRadio.value);
            const comment = document.getElementById('questionComment').value;

            AssessmentState.saveAnswer(dimId, questionNum, value, comment);
            showNotification('–û—Ç–≤–µ—Ç —Å–æ—Ö—Ä–∞–Ω—ë–Ω', 'success');
        }

        function previousQuestion() {
            if (questionNum > 1) {
                window.location.href = `phase2-question.html?dim=${dimId}&q=${questionNum - 1}`;
            } else {
                window.location.href = `phase2-dimension-intro.html?dim=${dimId}`;
            }
        }

        function nextQuestion() {
            const selectedRadio = document.querySelector('input[name="answer"]:checked');
            if (!selectedRadio) {
                showNotification('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ –æ—Ç–≤–µ—Ç', 'error');
                return;
            }

            saveAnswer();

            // Check if this is last question in dimension
            if (questionNum >= totalQuestions) {
                window.location.href = `phase2-dimension-complete.html?dim=${dimId}`;
            } else {
                window.location.href = `phase2-question.html?dim=${dimId}&q=${questionNum + 1}`;
            }
        }

        // Load privacy settings for comment visibility
        const privacy = sessionStorage.getItem('selectedPrivacy');
        const visibilityMap = {
            'name': '–í—Å–µ–º —á–ª–µ–Ω–∞–º —Å–µ–º—å–∏',
            'anonymous': '–¢–æ–ª—å–∫–æ —Ñ–∞—Å–∏–ª–∏—Ç–∞—Ç–æ—Ä—É (–∞–Ω–æ–Ω–∏–º–Ω–æ)',
            'fully_anonymous': '–ù–∏–∫–æ–º—É (–ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–Ω–æ–Ω–∏–º–Ω–æ)'
        };
        document.getElementById('commentVisibility').textContent = visibilityMap[privacy] || '–í—Å–µ–º —á–ª–µ–Ω–∞–º —Å–µ–º—å–∏';
    </script>
</body>
</html>
