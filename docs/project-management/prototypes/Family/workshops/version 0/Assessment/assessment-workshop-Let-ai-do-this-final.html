<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Blitz Assessment - Family Governance</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#FB6428',
                        background: '#F6F8FA',
                        card: '#FFFFFF',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            -webkit-font-smoothing: antialiased;
        }

        .fade-enter-active, .fade-leave-active {
            transition: opacity 0.3s ease, transform 0.3s ease;
        }
        .fade-enter-from {
            opacity: 0;
            transform: translateY(10px);
        }
        .fade-leave-to {
            opacity: 0;
            transform: translateY(-10px);
        }

        .question-option {
            transition: all 0.2s ease;
        }
        .question-option:hover:not(.selected) {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(251, 100, 40, 0.15);
        }
        .question-option.selected {
            border-color: #FB6428;
            background: rgba(251, 100, 40, 0.1);
        }

        .progress-bar {
            transition: width 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        .pulse {
            animation: pulse 2s infinite;
        }

        .ai-avatar {
            background: linear-gradient(135deg, #FB6428 0%, rgba(251, 100, 40, 0.8) 100%);
        }

        .typing-indicator span {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #FB6428;
            animation: typing 1.4s infinite;
            display: inline-block;
            margin: 0 2px;
        }
        .typing-indicator span:nth-child(2) { animation-delay: 0.2s; }
        .typing-indicator span:nth-child(3) { animation-delay: 0.4s; }

        @keyframes typing {
            0%, 60%, 100% { transform: translateY(0); }
            30% { transform: translateY(-10px); }
        }

        .method-card {
            transition: all 0.3s ease;
            cursor: pointer;
        }
        .method-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px rgba(0, 0, 0, 0.1);
        }
        .method-card.selected {
            border-color: #FB6428;
            background: rgba(251, 100, 40, 0.05);
        }
    </style>
</head>
<body class="bg-background">
    <div id="app"></div>

    <script type="module">
        const { createApp } = Vue;

        // 60 Questions Database (5 questions per category)
        const questionsDatabase = [
            // Block 1: Communication Patterns (5 questions)
            {
                id: 1,
                category: "Communication Patterns",
                categoryId: 1,
                question: "How often does your family communicate about important decisions?",
                type: "scale",
                options: ["Rarely", "Occasionally", "Monthly", "Weekly", "Daily"]
            },
            {
                id: 2,
                category: "Communication Patterns",
                categoryId: 1,
                question: "Do you have regular family meetings or calls?",
                type: "yesno",
                options: ["Yes", "No", "Not Sure"]
            },
            {
                id: 3,
                category: "Communication Patterns",
                categoryId: 1,
                question: "How comfortable are family members sharing concerns openly?",
                type: "scale",
                options: ["Very Uncomfortable", "Uncomfortable", "Neutral", "Comfortable", "Very Comfortable"]
            },
            {
                id: 4,
                category: "Communication Patterns",
                categoryId: 1,
                question: "What communication channels does your family primarily use?",
                type: "choice",
                options: ["In-person meetings only", "Phone/video calls", "Messaging apps", "Multiple channels"]
            },
            {
                id: 5,
                category: "Communication Patterns",
                categoryId: 1,
                question: "How well do family members listen to each other?",
                type: "scale",
                options: ["Poorly", "Fair", "Good", "Very Good", "Excellent"]
            },

            // Block 2: Decision-Making Process (5 questions)
            {
                id: 6,
                category: "Decision-Making Process",
                categoryId: 2,
                question: "Do you have formal rules for making family decisions?",
                type: "yesno",
                options: ["Yes", "No", "Not Sure"]
            },
            {
                id: 7,
                category: "Decision-Making Process",
                categoryId: 2,
                question: "Who typically makes major family decisions?",
                type: "choice",
                options: ["One senior member", "Parents/founders", "Family council", "Everyone equally"]
            },
            {
                id: 8,
                category: "Decision-Making Process",
                categoryId: 2,
                question: "How transparent is the decision-making process?",
                type: "scale",
                options: ["Not transparent", "Slightly transparent", "Moderately transparent", "Very transparent", "Completely transparent"]
            },
            {
                id: 9,
                category: "Decision-Making Process",
                categoryId: 2,
                question: "Are younger family members involved in important decisions?",
                type: "yesno",
                options: ["Yes", "No", "Sometimes"]
            },
            {
                id: 10,
                category: "Decision-Making Process",
                categoryId: 2,
                question: "How satisfied are you with the current decision-making process?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            },

            // Block 3: Conflict Resolution (5 questions)
            {
                id: 11,
                category: "Conflict Resolution",
                categoryId: 3,
                question: "Do you have a formal process for resolving family conflicts?",
                type: "yesno",
                options: ["Yes", "No", "Not Sure"]
            },
            {
                id: 12,
                category: "Conflict Resolution",
                categoryId: 3,
                question: "How does your family typically handle disagreements?",
                type: "choice",
                options: ["Open discussion", "Mediation by senior member", "Avoidance / time healing", "No formal process"]
            },
            {
                id: 13,
                category: "Conflict Resolution",
                categoryId: 3,
                question: "How comfortable are you addressing conflicts directly?",
                type: "scale",
                options: ["Very Uncomfortable", "Uncomfortable", "Neutral", "Comfortable", "Very Comfortable"]
            },
            {
                id: 14,
                category: "Conflict Resolution",
                categoryId: 3,
                question: "Have you ever used external mediators or advisors?",
                type: "yesno",
                options: ["Yes", "No", "Considering it"]
            },
            {
                id: 15,
                category: "Conflict Resolution",
                categoryId: 3,
                question: "How effectively does your family resolve conflicts?",
                type: "scale",
                options: ["Poorly", "Fair", "Good", "Very Good", "Excellent"]
            },

            // Block 4: Financial Transparency (5 questions)
            {
                id: 16,
                category: "Financial Transparency",
                categoryId: 4,
                question: "Do family members have access to financial information?",
                type: "yesno",
                options: ["Yes", "No", "Partial access"]
            },
            {
                id: 17,
                category: "Financial Transparency",
                categoryId: 4,
                question: "How often is financial information shared with the family?",
                type: "choice",
                options: ["Never", "Rarely", "Annually", "Quarterly", "Monthly"]
            },
            {
                id: 18,
                category: "Financial Transparency",
                categoryId: 4,
                question: "How transparent is your family about wealth and assets?",
                type: "scale",
                options: ["Not transparent", "Slightly transparent", "Moderately transparent", "Very transparent", "Completely transparent"]
            },
            {
                id: 19,
                category: "Financial Transparency",
                categoryId: 4,
                question: "Are investment decisions discussed openly with the family?",
                type: "yesno",
                options: ["Yes", "No", "Sometimes"]
            },
            {
                id: 20,
                category: "Financial Transparency",
                categoryId: 4,
                question: "How satisfied are you with the level of financial transparency?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            },

            // Block 5: Roles & Responsibilities (5 questions)
            {
                id: 21,
                category: "Roles & Responsibilities",
                categoryId: 5,
                question: "Are family roles and responsibilities clearly defined?",
                type: "yesno",
                options: ["Yes", "No", "Partially"]
            },
            {
                id: 22,
                category: "Roles & Responsibilities",
                categoryId: 5,
                question: "Who manages the family's business and investments?",
                type: "choice",
                options: ["One senior member", "Professional advisors", "Family committee", "Shared responsibility"]
            },
            {
                id: 23,
                category: "Roles & Responsibilities",
                categoryId: 5,
                question: "How clear are expectations for each family member?",
                type: "scale",
                options: ["Very Unclear", "Unclear", "Somewhat Clear", "Clear", "Very Clear"]
            },
            {
                id: 24,
                category: "Roles & Responsibilities",
                categoryId: 5,
                question: "Do you have a family council or governance board?",
                type: "yesno",
                options: ["Yes", "No", "Planning to create"]
            },
            {
                id: 25,
                category: "Roles & Responsibilities",
                categoryId: 5,
                question: "How satisfied are you with role clarity in your family?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            },

            // Block 6: Trust & Accountability (5 questions)
            {
                id: 26,
                category: "Trust & Accountability",
                categoryId: 6,
                question: "How much do you trust other family members with financial decisions?",
                type: "scale",
                options: ["No Trust", "Little Trust", "Moderate Trust", "High Trust", "Complete Trust"]
            },
            {
                id: 27,
                category: "Trust & Accountability",
                categoryId: 6,
                question: "Are family members held accountable for their commitments?",
                type: "yesno",
                options: ["Yes", "No", "Sometimes"]
            },
            {
                id: 28,
                category: "Trust & Accountability",
                categoryId: 6,
                question: "Do you have mechanisms to verify financial transactions?",
                type: "choice",
                options: ["No mechanisms", "Informal checks", "Annual audits", "Regular professional audits"]
            },
            {
                id: 29,
                category: "Trust & Accountability",
                categoryId: 6,
                question: "How transparent are family members about their actions?",
                type: "scale",
                options: ["Not transparent", "Slightly transparent", "Moderately transparent", "Very transparent", "Completely transparent"]
            },
            {
                id: 30,
                category: "Trust & Accountability",
                categoryId: 6,
                question: "Overall, how strong is trust within your family?",
                type: "scale",
                options: ["Very Weak", "Weak", "Moderate", "Strong", "Very Strong"]
            },

            // Block 7: Succession Readiness (5 questions)
            {
                id: 31,
                category: "Succession Readiness",
                categoryId: 7,
                question: "Do you have a formal succession plan?",
                type: "yesno",
                options: ["Yes", "No", "In development"]
            },
            {
                id: 32,
                category: "Succession Readiness",
                categoryId: 7,
                question: "How prepared is the next generation to take on leadership?",
                type: "scale",
                options: ["Not Prepared", "Somewhat Prepared", "Moderately Prepared", "Well Prepared", "Fully Prepared"]
            },
            {
                id: 33,
                category: "Succession Readiness",
                categoryId: 7,
                question: "Are younger family members receiving training and mentorship?",
                type: "yesno",
                options: ["Yes", "No", "Starting soon"]
            },
            {
                id: 34,
                category: "Succession Readiness",
                categoryId: 7,
                question: "How clear is the timeline for leadership transition?",
                type: "choice",
                options: ["No timeline", "Vague timeline", "Rough timeline", "Clear timeline"]
            },
            {
                id: 35,
                category: "Succession Readiness",
                categoryId: 7,
                question: "How confident are you in the succession plan?",
                type: "scale",
                options: ["Not Confident", "Slightly Confident", "Moderately Confident", "Confident", "Very Confident"]
            },

            // Block 8: Business Involvement (5 questions)
            {
                id: 36,
                category: "Business Involvement",
                categoryId: 8,
                question: "How involved is the family in business operations?",
                type: "choice",
                options: ["Not involved", "Oversight only", "Active management", "Full operational control"]
            },
            {
                id: 37,
                category: "Business Involvement",
                categoryId: 8,
                question: "Are there clear rules about family employment in the business?",
                type: "yesno",
                options: ["Yes", "No", "Informal guidelines"]
            },
            {
                id: 38,
                category: "Business Involvement",
                categoryId: 8,
                question: "How do family members gain business roles?",
                type: "choice",
                options: ["By birth right", "Based on qualifications", "Combination of both", "No clear process"]
            },
            {
                id: 39,
                category: "Business Involvement",
                categoryId: 8,
                question: "How satisfied are you with business-family boundaries?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            },
            {
                id: 40,
                category: "Business Involvement",
                categoryId: 8,
                question: "Do you separate family and business decision-making?",
                type: "yesno",
                options: ["Yes", "No", "Partially"]
            },

            // Block 9: Education & Development (5 questions)
            {
                id: 41,
                category: "Education & Development",
                categoryId: 9,
                question: "Does your family invest in financial education for members?",
                type: "yesno",
                options: ["Yes", "No", "Planning to"]
            },
            {
                id: 42,
                category: "Education & Development",
                categoryId: 9,
                question: "What type of development programs does your family provide?",
                type: "choice",
                options: ["None", "Informal mentoring", "Formal training programs", "Comprehensive development plans"]
            },
            {
                id: 43,
                category: "Education & Development",
                categoryId: 9,
                question: "How important is continuous learning in your family?",
                type: "scale",
                options: ["Not Important", "Slightly Important", "Moderately Important", "Important", "Very Important"]
            },
            {
                id: 44,
                category: "Education & Development",
                categoryId: 9,
                question: "Do younger members have access to educational resources?",
                type: "yesno",
                options: ["Yes", "No", "Limited access"]
            },
            {
                id: 45,
                category: "Education & Development",
                categoryId: 9,
                question: "How satisfied are you with family education initiatives?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            },

            // Block 10: Philanthropy Alignment (5 questions)
            {
                id: 46,
                category: "Philanthropy Alignment",
                categoryId: 10,
                question: "Does your family engage in philanthropic activities?",
                type: "yesno",
                options: ["Yes", "No", "Considering it"]
            },
            {
                id: 47,
                category: "Philanthropy Alignment",
                categoryId: 10,
                question: "How aligned are family members on philanthropic priorities?",
                type: "scale",
                options: ["Not Aligned", "Slightly Aligned", "Moderately Aligned", "Well Aligned", "Completely Aligned"]
            },
            {
                id: 48,
                category: "Philanthropy Alignment",
                categoryId: 10,
                question: "What percentage of wealth does your family commit to charity?",
                type: "choice",
                options: ["None", "Less than 1%", "1-5%", "More than 5%"]
            },
            {
                id: 49,
                category: "Philanthropy Alignment",
                categoryId: 10,
                question: "Do you have a formal philanthropy strategy?",
                type: "yesno",
                options: ["Yes", "No", "In development"]
            },
            {
                id: 50,
                category: "Philanthropy Alignment",
                categoryId: 10,
                question: "How important is philanthropy to your family's identity?",
                type: "scale",
                options: ["Not Important", "Slightly Important", "Moderately Important", "Important", "Very Important"]
            },

            // Block 11: Wealth Philosophy (5 questions)
            {
                id: 51,
                category: "Wealth Philosophy",
                categoryId: 11,
                question: "Does your family have a clear wealth philosophy?",
                type: "yesno",
                options: ["Yes", "No", "Developing one"]
            },
            {
                id: 52,
                category: "Wealth Philosophy",
                categoryId: 11,
                question: "What is your family's primary approach to wealth?",
                type: "choice",
                options: ["Preservation", "Growth", "Balanced approach", "No clear approach"]
            },
            {
                id: 53,
                category: "Wealth Philosophy",
                categoryId: 11,
                question: "How aligned are family members on wealth values?",
                type: "scale",
                options: ["Not Aligned", "Slightly Aligned", "Moderately Aligned", "Well Aligned", "Completely Aligned"]
            },
            {
                id: 54,
                category: "Wealth Philosophy",
                categoryId: 11,
                question: "Do you discuss wealth philosophy openly as a family?",
                type: "yesno",
                options: ["Yes", "No", "Rarely"]
            },
            {
                id: 55,
                category: "Wealth Philosophy",
                categoryId: 11,
                question: "How important is wealth stewardship to future generations?",
                type: "scale",
                options: ["Not Important", "Slightly Important", "Moderately Important", "Important", "Very Important"]
            },

            // Block 12: Family Unity & Values (5 questions)
            {
                id: 56,
                category: "Family Unity & Values",
                categoryId: 12,
                question: "How strong is the sense of unity in your family?",
                type: "scale",
                options: ["Very Weak", "Weak", "Moderate", "Strong", "Very Strong"]
            },
            {
                id: 57,
                category: "Family Unity & Values",
                categoryId: 12,
                question: "Have you defined core family values together?",
                type: "yesno",
                options: ["Yes", "No", "In progress"]
            },
            {
                id: 58,
                category: "Family Unity & Values",
                categoryId: 12,
                question: "How often does your family gather for non-business purposes?",
                type: "choice",
                options: ["Rarely", "Annually", "Quarterly", "Monthly"]
            },
            {
                id: 59,
                category: "Family Unity & Values",
                categoryId: 12,
                question: "How well do family members understand shared values?",
                type: "scale",
                options: ["Poorly", "Fair", "Good", "Very Good", "Excellent"]
            },
            {
                id: 60,
                category: "Family Unity & Values",
                categoryId: 12,
                question: "Overall, how satisfied are you with family unity?",
                type: "scale",
                options: ["Very Dissatisfied", "Dissatisfied", "Neutral", "Satisfied", "Very Satisfied"]
            }
        ];

        // Test data for 4 family members
        const testFamilyResponses = [
            {
                name: "John Smith",
                role: "Client",
                completed: true,
                responses: Array.from({length: 60}, (_, i) => Math.floor(Math.random() * 5))
            },
            {
                name: "Mary Smith",
                role: "Client",
                completed: true,
                responses: Array.from({length: 60}, (_, i) => Math.floor(Math.random() * 5))
            },
            {
                name: "David Smith",
                role: "Client",
                completed: true,
                responses: Array.from({length: 60}, (_, i) => Math.floor(Math.random() * 5))
            },
            {
                name: "Sarah Smith",
                role: "Client",
                completed: false,
                responses: []
            }
        ];

        createApp({
            data() {
                return {
                    currentScreen: 'method-selection',
                    selectedMethod: 'ai-automated',
                    userName: '',
                    userRole: 'Client',
                    currentQuestionIndex: 0,
                    responses: [],
                    questions: questionsDatabase,
                    familyResponses: testFamilyResponses,
                    showAIThinking: false,
                    constitutionDraft: null
                }
            },
            computed: {
                currentQuestion() {
                    return this.questions[this.currentQuestionIndex];
                },
                progress() {
                    return Math.round((this.currentQuestionIndex / this.questions.length) * 100);
                },
                categoryProgress() {
                    const categoryQuestions = this.questions.filter(q => q.categoryId === this.currentQuestion.categoryId);
                    const categoryIndex = this.questions.filter((q, i) => i <= this.currentQuestionIndex && q.categoryId === this.currentQuestion.categoryId).length;
                    return `${categoryIndex} of ${categoryQuestions.length}`;
                },
                completedResponses() {
                    return this.familyResponses.filter(r => r.completed).length;
                },
                allCompleted() {
                    return this.familyResponses.every(r => r.completed);
                }
            },
            methods: {
                selectMethod(method) {
                    this.selectedMethod = method;
                    if (method === 'ai-automated') {
                        this.currentScreen = 'welcome';
                    } else {
                        alert('This method is not yet implemented in this prototype. Showing AI Blitz Assessment.');
                        this.selectedMethod = 'ai-automated';
                        this.currentScreen = 'welcome';
                    }
                },
                startAssessment() {
                    if (!this.userName.trim()) {
                        alert('Please enter your name');
                        return;
                    }
                    this.userRole = 'Client';
                    this.currentScreen = 'assessment';
                },
                answerQuestion(answerIndex) {
                    this.responses.push(answerIndex);

                    if (this.currentQuestionIndex < this.questions.length - 1) {
                        this.currentQuestionIndex++;
                    } else {
                        this.completeAssessment();
                    }
                },
                completeAssessment() {
                    // Save current user's responses
                    const currentUser = {
                        name: this.userName,
                        role: this.userRole,
                        completed: true,
                        responses: this.responses
                    };

                    // Add to family responses if not exists
                    const existingIndex = this.familyResponses.findIndex(r => r.name === this.userName);
                    if (existingIndex >= 0) {
                        this.familyResponses[existingIndex] = currentUser;
                    } else {
                        this.familyResponses.push(currentUser);
                    }

                    this.currentScreen = 'dashboard';
                },
                analyzeResponses() {
                    this.showAIThinking = true;
                    this.currentScreen = 'analysis';

                    setTimeout(() => {
                        this.generateConstitutionDraft();
                        this.showAIThinking = false;
                        this.currentScreen = 'report';
                    }, 3000);
                },
                generateConstitutionDraft() {
                    // AI Analysis logic (simplified for demo)
                    const avgScores = Array(12).fill(0).map((_, categoryId) => {
                        const categoryQuestions = this.questions.filter(q => q.categoryId === categoryId + 1);
                        const allResponses = this.familyResponses
                            .filter(r => r.completed)
                            .flatMap(r => categoryQuestions.map((q, i) => r.responses[q.id - 1] || 0));

                        return allResponses.reduce((a, b) => a + b, 0) / allResponses.length;
                    });

                    this.constitutionDraft = {
                        overallScore: (avgScores.reduce((a, b) => a + b, 0) / avgScores.length).toFixed(1),
                        categoryScores: avgScores,
                        sections: this.generateSections(avgScores),
                        recommendations: this.generateRecommendations(avgScores)
                    };
                },
                generateSections(avgScores) {
                    return [
                        {
                            title: "Preamble",
                            content: `We, the ${this.userName.split(' ')[1] || 'Family'}, united by shared values and commitment to our collective future, establish this Constitution to guide our family governance for generations to come.`
                        },
                        {
                            title: "Family Values & Mission",
                            content: avgScores[0] > 3
                                ? "Strong communication, transparency, and mutual respect form the foundation of our family values."
                                : "Our family is committed to improving communication and fostering open dialogue among all members."
                        },
                        {
                            title: "Governance Structure",
                            content: avgScores[1] > 3
                                ? "Family council meets quarterly to make major decisions through structured voting processes."
                                : "We recognize the need to formalize our governance structure with clear decision-making protocols."
                        },
                        {
                            title: "Wealth Management",
                            content: avgScores[3] > 3
                                ? "Professional advisors manage our portfolio with regular reporting to all family members."
                                : "We are developing transparent wealth management practices with defined reporting mechanisms."
                        },
                        {
                            title: "Education & Development",
                            content: avgScores[8] > 3
                                ? "Mandatory financial literacy programs for next generation, with ongoing professional development."
                                : "We commit to establishing comprehensive education programs for all family members."
                        },
                        {
                            title: "Decision Making",
                            content: avgScores[1] > 3
                                ? "Major decisions require 75% vote approval from family council members."
                                : "We will implement formal voting rules and decision-making thresholds."
                        },
                        {
                            title: "Succession Planning",
                            content: avgScores[6] > 3
                                ? "Mentorship program pairs next generation with current leaders for 5-year transition."
                                : "We recognize the critical need for formal succession planning and leadership development."
                        },
                        {
                            title: "Family Philanthropy",
                            content: avgScores[9] > 3
                                ? "5% annual giving commitment focused on education and community development."
                                : "We are exploring philanthropic opportunities aligned with our family values."
                        },
                        {
                            title: "Conflict Resolution",
                            content: avgScores[2] > 3
                                ? "3-step mediation process: direct dialogue, family council mediation, external arbitration."
                                : "We will establish formal conflict resolution procedures with clear escalation paths."
                        },
                        {
                            title: "Voting Rules",
                            content: "One vote per adult family member. Major decisions require 75% approval. Amendments require unanimous consent."
                        },
                        {
                            title: "Amendment Process",
                            content: "Constitution amendments require: (1) written proposal, (2) 30-day review period, (3) family meeting discussion, (4) unanimous vote approval."
                        }
                    ];
                },
                generateRecommendations(avgScores) {
                    const categoryNames = [
                        "Communication Patterns",
                        "Decision-Making Process",
                        "Conflict Resolution",
                        "Financial Transparency",
                        "Roles & Responsibilities",
                        "Trust & Accountability",
                        "Succession Readiness",
                        "Business Involvement",
                        "Education & Development",
                        "Philanthropy Alignment",
                        "Wealth Philosophy",
                        "Family Unity & Values"
                    ];

                    const weakAreas = avgScores
                        .map((score, i) => ({ score, category: categoryNames[i], index: i }))
                        .filter(item => item.score < 3)
                        .sort((a, b) => a.score - b.score)
                        .slice(0, 3);

                    return weakAreas.length > 0
                        ? weakAreas.map(area => ({
                            category: area.category,
                            priority: area.score < 2 ? "High Priority" : "Medium Priority",
                            recommendation: this.getRecommendation(area.index)
                        }))
                        : [{ category: "Overall", priority: "Low Priority", recommendation: "Your family shows strong governance practices across all dimensions. Focus on continuous improvement and regular reviews." }];
                },
                getRecommendation(categoryIndex) {
                    const recommendations = [
                        "Establish regular family meetings (monthly or quarterly) with structured agendas.",
                        "Create formal decision-making framework with clear voting thresholds and approval processes.",
                        "Implement 3-step conflict resolution process: direct dialogue ‚Üí family mediation ‚Üí external arbitration.",
                        "Schedule quarterly financial transparency sessions with professional advisors present.",
                        "Document roles and responsibilities in family governance charter with annual reviews.",
                        "Conduct regular trust-building exercises and transparent accountability mechanisms.",
                        "Develop 5-year succession plan with mentorship programs for next generation.",
                        "Define clear policies for family business involvement based on qualifications and merit.",
                        "Launch family education program with financial literacy and leadership development modules.",
                        "Align on shared philanthropic vision through family retreats and structured discussions.",
                        "Co-create wealth philosophy statement through facilitated family workshops.",
                        "Organize annual family retreats focused on values alignment and relationship building."
                    ];
                    return recommendations[categoryIndex];
                }
            },
            template: `
                <div class="min-h-screen py-8">
                    <div class="max-w-6xl mx-auto px-4">

                        <!-- Method Selection Screen -->
                        <transition name="fade" mode="out-in">
                            <div v-if="currentScreen === 'method-selection'" class="space-y-6">
                                <!-- Header -->
                                <div class="text-center mb-8">
                                    <h1 class="text-3xl font-bold text-gray-900 mb-2">Family Assessment Workshop</h1>
                                    <p class="text-gray-600">Step 4 of 8: Understanding Your Family Dynamics</p>
                                </div>

                                <!-- Progress bar -->
                                <div class="bg-card rounded-lg shadow-sm p-6 mb-8">
                                    <div class="flex justify-between text-sm text-gray-600 mb-2">
                                        <span>Setup Progress</span>
                                        <span>Step 4 of 8</span>
                                    </div>
                                    <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                        <div class="h-full bg-primary" style="width: 50%"></div>
                                    </div>
                                </div>

                                <!-- Method selection -->
                                <div class="bg-card rounded-lg shadow-sm p-8">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-2">How would you like to complete the Assessment?</h2>
                                    <p class="text-gray-600 mb-8">Choose the method that works best for your family's needs and schedule.</p>

                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <!-- Workshop with Advisor -->
                                        <div
                                            @click="selectMethod('workshop-advisor')"
                                            class="method-card border-2 border-gray-200 rounded-xl p-6 cursor-pointer"
                                            :class="{'selected': selectedMethod === 'workshop-advisor'}"
                                        >
                                            <div class="text-5xl mb-4">üë®‚Äçüíº</div>
                                            <h3 class="text-xl font-semibold text-gray-900 mb-2">Workshop with Advisor</h3>
                                            <p class="text-gray-600 text-sm mb-4">Professional guidance from family governance expert</p>
                                            <div class="text-primary font-semibold">$500-1500 per session</div>
                                        </div>

                                        <!-- Workshop with AI -->
                                        <div
                                            @click="selectMethod('workshop-ai')"
                                            class="method-card border-2 border-gray-200 rounded-xl p-6 cursor-pointer"
                                            :class="{'selected': selectedMethod === 'workshop-ai'}"
                                        >
                                            <div class="text-5xl mb-4">ü§ñ</div>
                                            <h3 class="text-xl font-semibold text-gray-900 mb-2">Workshop with AI</h3>
                                            <p class="text-gray-600 text-sm mb-4">AI-guided collaborative online workshop</p>
                                            <div class="text-primary font-semibold">Included in subscription</div>
                                        </div>

                                        <!-- Let AI do this (selected by default) -->
                                        <div
                                            @click="selectMethod('ai-automated')"
                                            class="method-card border-2 border-primary rounded-xl p-6 cursor-pointer bg-orange-50"
                                        >
                                            <div class="text-5xl mb-4">‚ö°</div>
                                            <h3 class="text-xl font-semibold text-gray-900 mb-2">Let AI do this</h3>
                                            <p class="text-gray-600 text-sm mb-4">Fully automated assessment based on existing data</p>
                                            <div class="text-primary font-semibold">Free</div>
                                        </div>

                                        <!-- Manual -->
                                        <div
                                            @click="selectMethod('manual')"
                                            class="method-card border-2 border-gray-200 rounded-xl p-6 cursor-pointer"
                                            :class="{'selected': selectedMethod === 'manual'}"
                                        >
                                            <div class="text-5xl mb-4">‚úçÔ∏è</div>
                                            <h3 class="text-xl font-semibold text-gray-900 mb-2">I'll do it manually</h3>
                                            <p class="text-gray-600 text-sm mb-4">Fill out assessment forms yourself</p>
                                            <div class="text-primary font-semibold">Free</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Welcome Screen -->
                            <div v-else-if="currentScreen === 'welcome'" class="bg-card rounded-lg shadow-sm p-8">
                                <div class="text-center mb-8">
                                    <div class="w-20 h-20 rounded-full ai-avatar flex items-center justify-center mx-auto mb-4">
                                        <span class="text-white text-3xl">ü§ñ</span>
                                    </div>
                                    <h1 class="text-3xl font-bold text-gray-900 mb-2">AI Blitz Assessment</h1>
                                    <p class="text-gray-600">Quick 10-15 minute family governance assessment</p>
                                </div>

                                <div class="max-w-md mx-auto space-y-6">
                                    <div>
                                        <label class="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                                        <input
                                            v-model="userName"
                                            type="text"
                                            class="w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:border-primary focus:outline-none"
                                            placeholder="Enter your full name"
                                            @keyup.enter="startAssessment"
                                        />
                                    </div>

                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 text-sm text-gray-700">
                                        <p><strong>üí° What to expect:</strong></p>
                                        <ul class="mt-2 space-y-1 ml-4">
                                            <li>‚Ä¢ 60 quick questions (5 per category)</li>
                                            <li>‚Ä¢ 10-15 minutes to complete</li>
                                            <li>‚Ä¢ AI-generated constitution draft</li>
                                            <li>‚Ä¢ Personalized recommendations</li>
                                        </ul>
                                    </div>

                                    <button
                                        @click="startAssessment"
                                        class="w-full py-4 bg-primary rounded-lg font-medium text-white hover:bg-orange-600 transition-all"
                                    >
                                        Start Assessment ‚Üí
                                    </button>
                                </div>
                            </div>

                            <!-- Assessment Screen -->
                            <div v-else-if="currentScreen === 'assessment'" class="space-y-6">
                                <!-- Header with AI -->
                                <div class="bg-card rounded-lg shadow-sm p-6">
                                    <div class="flex items-center gap-4 mb-4">
                                        <div class="w-12 h-12 rounded-full ai-avatar flex items-center justify-center">
                                            <span class="text-white text-xl">ü§ñ</span>
                                        </div>
                                        <div>
                                            <div class="font-medium text-gray-900">Hi {{ userName }}! üëã</div>
                                            <div class="text-sm text-gray-600">
                                                Let's assess your family governance together.
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Progress bars -->
                                    <div class="space-y-3">
                                        <div>
                                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                                <span>Overall Progress</span>
                                                <span>{{ currentQuestionIndex + 1 }} / {{ questions.length }}</span>
                                            </div>
                                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                                <div class="progress-bar h-full bg-primary" :style="{width: progress + '%'}"></div>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="flex justify-between text-sm text-gray-600 mb-2">
                                                <span>{{ currentQuestion.category }}</span>
                                                <span>{{ categoryProgress }}</span>
                                            </div>
                                            <div class="h-2 bg-gray-200 rounded-full overflow-hidden">
                                                <div class="progress-bar h-full bg-green-500" :style="{width: (parseInt(categoryProgress.split(' ')[0]) / 5 * 100) + '%'}"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Question Card -->
                                <div class="bg-card rounded-lg shadow-sm p-8">
                                    <div class="mb-6">
                                        <div class="text-sm font-medium text-primary mb-2">Question {{ currentQuestionIndex + 1 }} of {{ questions.length }}</div>
                                        <h2 class="text-xl font-medium text-gray-900">{{ currentQuestion.question }}</h2>
                                    </div>

                                    <!-- Scale options -->
                                    <div v-if="currentQuestion.type === 'scale'" class="grid grid-cols-5 gap-3">
                                        <button
                                            v-for="(option, index) in currentQuestion.options"
                                            :key="index"
                                            @click="answerQuestion(index)"
                                            class="question-option border-2 border-gray-200 rounded-lg p-4 text-center hover:shadow-lg transition-all"
                                        >
                                            <div class="text-2xl font-bold text-primary mb-2">{{ index + 1 }}</div>
                                            <div class="text-xs text-gray-600">{{ option }}</div>
                                        </button>
                                    </div>

                                    <!-- Yes/No options -->
                                    <div v-else-if="currentQuestion.type === 'yesno'" class="grid grid-cols-3 gap-4">
                                        <button
                                            v-for="(option, index) in currentQuestion.options"
                                            :key="index"
                                            @click="answerQuestion(index)"
                                            class="question-option border-2 border-gray-200 rounded-lg p-6 text-center hover:shadow-lg transition-all"
                                        >
                                            <div class="text-lg font-medium text-gray-900">{{ option }}</div>
                                        </button>
                                    </div>

                                    <!-- Choice options -->
                                    <div v-else-if="currentQuestion.type === 'choice'" class="space-y-3">
                                        <button
                                            v-for="(option, index) in currentQuestion.options"
                                            :key="index"
                                            @click="answerQuestion(index)"
                                            class="question-option w-full border-2 border-gray-200 rounded-lg p-4 text-left hover:shadow-lg transition-all"
                                        >
                                            <div class="text-base text-gray-900">{{ option }}</div>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Dashboard Screen -->
                            <div v-else-if="currentScreen === 'dashboard'" class="space-y-6">
                                <div class="bg-card rounded-lg shadow-sm p-6">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-2">Family Assessment Dashboard</h2>
                                    <p class="text-gray-600 mb-6">Track completion status for all family members</p>

                                    <!-- Completion Status -->
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                                        <div
                                            v-for="(member, index) in familyResponses"
                                            :key="index"
                                            class="border-2 rounded-lg p-4"
                                            :class="member.completed ? 'border-green-500 bg-green-50' : 'border-gray-200'"
                                        >
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div class="font-medium text-gray-900">{{ member.name }}</div>
                                                    <div class="text-sm text-gray-600">{{ member.role }}</div>
                                                </div>
                                                <div v-if="member.completed" class="text-green-600">
                                                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                                                    </svg>
                                                </div>
                                                <div v-else class="text-gray-400">
                                                    <svg class="w-8 h-8" fill="currentColor" viewBox="0 0 20 20">
                                                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>
                                                    </svg>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Progress summary -->
                                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-6 text-center mb-6">
                                        <div class="text-4xl font-bold text-primary mb-2">{{ completedResponses }} / {{ familyResponses.length }}</div>
                                        <div class="text-gray-700">Family members completed</div>
                                    </div>

                                    <!-- Action button -->
                                    <button
                                        @click="analyzeResponses"
                                        class="w-full py-4 rounded-lg font-medium text-white transition-all bg-primary hover:bg-orange-600"
                                    >
                                        Analyze Responses & Generate Report ‚Üí
                                    </button>
                                    <p v-if="!allCompleted" class="text-center text-sm text-gray-500 mt-2">
                                        Note: {{ familyResponses.length - completedResponses }} member(s) haven't completed yet. Analysis will be based on {{ completedResponses }} responses.
                                    </p>
                                </div>
                            </div>

                            <!-- Analysis Screen -->
                            <div v-else-if="currentScreen === 'analysis'" class="space-y-6">
                                <div class="bg-card rounded-lg shadow-sm p-12 text-center">
                                    <div class="w-24 h-24 rounded-full ai-avatar flex items-center justify-center mx-auto mb-6 pulse">
                                        <span class="text-white text-4xl">ü§ñ</span>
                                    </div>
                                    <h2 class="text-2xl font-bold text-gray-900 mb-4">AI is analyzing responses...</h2>
                                    <div class="typing-indicator flex justify-center mb-6">
                                        <span></span>
                                        <span></span>
                                        <span></span>
                                    </div>
                                    <div class="space-y-2 text-gray-600 max-w-md mx-auto">
                                        <p>‚úì Processing {{ completedResponses }} family member responses</p>
                                        <p>‚úì Analyzing 12 governance dimensions</p>
                                        <p>‚úì Identifying consensus and gaps</p>
                                        <p>‚úì Generating constitution draft...</p>
                                    </div>
                                </div>
                            </div>

                            <!-- Report Screen -->
                            <div v-else-if="currentScreen === 'report' && constitutionDraft" class="space-y-6">
                                <!-- Overall Score -->
                                <div class="bg-card rounded-lg shadow-sm p-8 text-center">
                                    <h2 class="text-2xl font-bold text-gray-900 mb-4">Constitution Draft Generated</h2>
                                    <div class="text-6xl font-bold text-primary mb-2">{{ constitutionDraft.overallScore }}/5</div>
                                    <div class="text-gray-600">Overall Family Governance Readiness</div>
                                </div>

                                <!-- Constitution Sections -->
                                <div class="bg-card rounded-lg shadow-sm p-8">
                                    <h3 class="text-xl font-bold text-gray-900 mb-6">üìÑ Draft Constitution Sections</h3>
                                    <div class="space-y-6">
                                        <div
                                            v-for="(section, index) in constitutionDraft.sections"
                                            :key="index"
                                            class="border-l-4 border-primary pl-6 py-2"
                                        >
                                            <h4 class="text-lg font-semibold text-gray-900 mb-2">{{ index + 1 }}. {{ section.title }}</h4>
                                            <p class="text-gray-700 leading-relaxed">{{ section.content }}</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- Recommendations -->
                                <div class="bg-card rounded-lg shadow-sm p-8">
                                    <h3 class="text-xl font-bold text-gray-900 mb-6">üí° AI Recommendations</h3>
                                    <div class="space-y-4">
                                        <div
                                            v-for="(rec, index) in constitutionDraft.recommendations"
                                            :key="index"
                                            class="border border-yellow-200 bg-yellow-50 rounded-lg p-4"
                                        >
                                            <div class="flex items-start gap-3">
                                                <div class="text-2xl">‚ö†Ô∏è</div>
                                                <div class="flex-1">
                                                    <div class="font-semibold text-gray-900 mb-1">{{ rec.category }}</div>
                                                    <div class="text-sm text-yellow-700 mb-2">Priority: {{ rec.priority }}</div>
                                                    <div class="text-gray-700">{{ rec.recommendation }}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Action buttons -->
                                <div class="flex gap-4">
                                    <button
                                        @click="currentScreen = 'method-selection'"
                                        class="flex-1 py-4 border-2 border-gray-300 rounded-lg font-medium text-gray-700 hover:bg-gray-50"
                                    >
                                        Start New Assessment
                                    </button>
                                    <button
                                        class="flex-1 py-4 bg-primary rounded-lg font-medium text-white hover:bg-orange-600"
                                    >
                                        Export Constitution Draft
                                    </button>
                                </div>
                            </div>
                        </transition>

                    </div>
                </div>
            `
        }).mount('#app');
    </script>
</body>
</html>
