<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Values, Mission & Vision Workshop</title>
    <style>
        /* REUI-inspired Design System */
        :root {
            /* Family Portal Theme Colors (Orange) */
            --primary: #f97316;
            --primary-dark: #ea580c;
            --primary-light: #fb923c;
            --secondary: #64748b;
            --background: #ffffff;
            --surface: #f8fafc;
            --border: #e2e8f0;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #94a3b8;
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;

            /* Spacing */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;

            /* Typography */
            --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            --font-size-xs: 0.75rem;
            --font-size-sm: 0.875rem;
            --font-size-base: 1rem;
            --font-size-lg: 1.125rem;
            --font-size-xl: 1.25rem;
            --font-size-2xl: 1.5rem;
            --font-size-3xl: 1.875rem;
            --font-size-4xl: 2.25rem;

            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;

            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
        }

        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-sans);
            font-size: var(--font-size-base);
            color: var(--text-primary);
            background-color: var(--surface);
            line-height: 1.6;
            padding: var(--spacing-md);
        }

        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        /* Card Component */
        .card {
            background-color: var(--background);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            padding: var(--spacing-xl);
            margin-bottom: var(--spacing-lg);
        }

        /* Typography */
        h1 {
            font-size: var(--font-size-4xl);
            font-weight: 700;
            margin-bottom: var(--spacing-lg);
            color: var(--text-primary);
        }

        h2 {
            font-size: var(--font-size-2xl);
            font-weight: 600;
            margin-bottom: var(--spacing-md);
            color: var(--text-primary);
        }

        h3 {
            font-size: var(--font-size-xl);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        p {
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
        }

        /* Button Component */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-lg);
            font-size: var(--font-size-base);
            font-weight: 500;
            border-radius: var(--radius-md);
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
            text-decoration: none;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-dark);
            box-shadow: var(--shadow-lg);
        }

        .btn-secondary {
            background-color: transparent;
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background-color: var(--surface);
            border-color: var(--primary);
            color: var(--primary);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn-group {
            display: flex;
            gap: var(--spacing-md);
            margin-top: var(--spacing-lg);
        }

        /* Progress Bar */
        .progress-container {
            margin-bottom: var(--spacing-xl);
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: var(--spacing-sm);
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: var(--border);
            border-radius: var(--radius-xl);
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background-color: var(--primary);
            transition: width 0.3s ease;
        }

        /* Input Components */
        .form-group {
            margin-bottom: var(--spacing-lg);
        }

        .form-label {
            display: block;
            font-size: var(--font-size-sm);
            font-weight: 500;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .form-input,
        .form-textarea,
        .form-select {
            width: 100%;
            padding: var(--spacing-sm) var(--spacing-md);
            font-size: var(--font-size-base);
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background-color: var(--background);
            color: var(--text-primary);
            transition: all 0.2s ease;
        }

        .form-input:focus,
        .form-textarea:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(249, 115, 22, 0.1);
        }

        .form-textarea {
            min-height: 100px;
            resize: vertical;
        }

        /* Checkbox & Radio */
        .checkbox-group,
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: var(--spacing-md);
        }

        .checkbox-item,
        .radio-item {
            display: flex;
            align-items: flex-start;
            gap: var(--spacing-sm);
            cursor: pointer;
        }

        .checkbox-item input,
        .radio-item input {
            margin-top: 4px;
            width: 18px;
            height: 18px;
            cursor: pointer;
            accent-color: var(--primary);
        }

        .checkbox-label,
        .radio-label {
            flex: 1;
        }

        .checkbox-label strong,
        .radio-label strong {
            display: block;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .checkbox-label span,
        .radio-label span {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        /* Slider */
        .slider-group {
            margin-bottom: var(--spacing-lg);
        }

        .slider {
            width: 100%;
            height: 6px;
            border-radius: var(--radius-xl);
            background: var(--border);
            outline: none;
            -webkit-appearance: none;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: none;
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: var(--spacing-sm);
            font-size: var(--font-size-xs);
            color: var(--text-muted);
        }

        /* Badge Component */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: var(--spacing-xs) var(--spacing-sm);
            font-size: var(--font-size-xs);
            font-weight: 500;
            border-radius: var(--radius-sm);
            background-color: var(--surface);
            color: var(--text-secondary);
            border: 1px solid var(--border);
        }

        .badge-primary {
            background-color: rgba(249, 115, 22, 0.1);
            color: var(--primary);
            border-color: var(--primary-light);
        }

        /* Value Cards */
        .value-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--spacing-md);
            margin-bottom: var(--spacing-lg);
        }

        .value-card {
            border: 2px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            cursor: pointer;
            transition: all 0.2s ease;
            background-color: var(--background);
        }

        .value-card:hover {
            border-color: var(--primary-light);
            box-shadow: var(--shadow-md);
        }

        .value-card.selected {
            border-color: var(--primary);
            background-color: rgba(249, 115, 22, 0.05);
        }

        .value-card-icon {
            font-size: var(--font-size-3xl);
            margin-bottom: var(--spacing-sm);
        }

        .value-card-title {
            font-size: var(--font-size-lg);
            font-weight: 600;
            margin-bottom: var(--spacing-sm);
            color: var(--text-primary);
        }

        .value-card-description {
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        /* Vote Buttons */
        .vote-buttons {
            display: flex;
            gap: var(--spacing-sm);
            margin-top: var(--spacing-md);
        }

        .vote-btn {
            flex: 1;
            padding: var(--spacing-sm);
            border-radius: var(--radius-md);
            border: 2px solid var(--border);
            background: var(--background);
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: var(--font-size-sm);
        }

        .vote-btn:hover {
            border-color: var(--primary-light);
        }

        .vote-btn.selected-important {
            border-color: var(--success);
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .vote-btn.selected-neutral {
            border-color: var(--secondary);
            background-color: var(--surface);
            color: var(--secondary);
        }

        .vote-btn.selected-not {
            border-color: var(--error);
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--error);
        }

        /* Alert Component */
        .alert {
            padding: var(--spacing-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--spacing-lg);
            border-left: 4px solid;
        }

        .alert-info {
            background-color: rgba(59, 130, 246, 0.1);
            border-color: #3b82f6;
            color: #1e40af;
        }

        .alert-success {
            background-color: rgba(16, 185, 129, 0.1);
            border-color: var(--success);
            color: #065f46;
        }

        /* Step Navigation */
        .step-hidden {
            display: none;
        }

        .step-visible {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Results Display */
        .results-section {
            background-color: var(--surface);
            padding: var(--spacing-lg);
            border-radius: var(--radius-lg);
            margin-bottom: var(--spacing-lg);
        }

        .results-list {
            list-style: none;
            padding: 0;
        }

        .results-list li {
            padding: var(--spacing-md);
            margin-bottom: var(--spacing-sm);
            background-color: var(--background);
            border-radius: var(--radius-md);
            border-left: 3px solid var(--primary);
        }

        .results-list li strong {
            display: block;
            color: var(--text-primary);
            margin-bottom: var(--spacing-xs);
        }

        .results-list li p {
            margin: 0;
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
        }

        /* Timer Display */
        .timer {
            display: inline-flex;
            align-items: center;
            gap: var(--spacing-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            background-color: var(--surface);
            border-radius: var(--radius-md);
            font-size: var(--font-size-sm);
            color: var(--text-secondary);
            margin-bottom: var(--spacing-md);
        }

        .timer-active {
            background-color: rgba(249, 115, 22, 0.1);
            color: var(--primary);
        }

        /* Generated Content Preview */
        .generated-preview {
            background-color: var(--surface);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            padding: var(--spacing-lg);
            margin-bottom: var(--spacing-lg);
            position: relative;
        }

        .generated-preview::before {
            content: '‚ú® AI Generated';
            position: absolute;
            top: var(--spacing-md);
            right: var(--spacing-md);
            font-size: var(--font-size-xs);
            color: var(--primary);
            background-color: rgba(249, 115, 22, 0.1);
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--radius-sm);
        }

        .generated-preview-text {
            font-size: var(--font-size-lg);
            line-height: 1.8;
            color: var(--text-primary);
            font-style: italic;
        }

        /* Responsive */
        @media (max-width: 768px) {
            body {
                padding: var(--spacing-sm);
            }

            .card {
                padding: var(--spacing-lg);
            }

            h1 {
                font-size: var(--font-size-3xl);
            }

            h2 {
                font-size: var(--font-size-xl);
            }

            .btn-group {
                flex-direction: column;
            }

            .btn-group .btn {
                width: 100%;
            }

            .value-cards {
                grid-template-columns: 1fr;
            }
        }

        /* Loading State */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid var(--border);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Progress Bar -->
        <div class="progress-container">
            <div class="progress-label">
                <span id="progress-step-label">Introduction</span>
                <span id="progress-percentage">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
            </div>
        </div>

        <!-- Step 0: Welcome -->
        <div id="step-0" class="step-visible">
            <div class="card">
                <h1>Family Values, Mission & Vision Workshop</h1>
                <p>Welcome to an AI-powered interactive workshop designed to help your family articulate core values, mission, and vision.</p>

                <div class="alert alert-info">
                    <strong>Workshop Duration:</strong> Approximately 60-90 minutes<br>
                    <strong>Approach:</strong> AI-guided with minimal writing required
                </div>

                <h3>What You'll Accomplish:</h3>
                <ul style="margin-left: var(--spacing-lg); margin-bottom: var(--spacing-lg); color: var(--text-secondary);">
                    <li>Define 4-7 core family values</li>
                    <li>Create a clear mission statement</li>
                    <li>Develop an inspiring vision for your family's future</li>
                    <li>Generate a beautiful PDF document to preserve your decisions</li>
                </ul>

                <h3>How It Works:</h3>
                <p>This workshop minimizes manual writing. You'll:</p>
                <ul style="margin-left: var(--spacing-lg); margin-bottom: var(--spacing-lg); color: var(--text-secondary);">
                    <li>Select from pre-curated value packs</li>
                    <li>Vote on priorities using simple clicks</li>
                    <li>Adjust AI-generated content with sliders</li>
                    <li>Choose from multiple AI-generated options</li>
                </ul>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="startWorkshop()">Begin Workshop ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 1: Family Profile Setup -->
        <div id="step-1" class="step-hidden">
            <div class="card">
                <h2>Step 1: Family Profile Setup</h2>
                <p>Let's start by understanding your family context. This helps us recommend relevant values and content.</p>

                <div class="form-group">
                    <label class="form-label">Family Type</label>
                    <select class="form-select" id="family-type">
                        <option value="">Select your family type...</option>
                        <option value="active-business">Family with Active Business</option>
                        <option value="investor">Family as Investor</option>
                        <option value="no-business">Family without Business (Focus on Education & Well-being)</option>
                        <option value="mixed">Mixed (Business + Capital)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Stage of Journey</label>
                    <select class="form-select" id="family-stage">
                        <option value="">Select your stage...</option>
                        <option value="beginning">Beginning to Form Family System</option>
                        <option value="formalizing">Already Have Traditions, Want to Formalize</option>
                        <option value="complex">Complex Structure (Multiple Branches/Businesses)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label">Planning Horizon: <span id="horizon-value">20</span> years</label>
                    <input type="range" class="slider" id="planning-horizon" min="10" max="50" value="20" step="5"
                           oninput="document.getElementById('horizon-value').textContent = this.value">
                    <div class="slider-labels">
                        <span>10 years</span>
                        <span>30 years</span>
                        <span>50+ years</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Primary Focus (select all that apply)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="focus" value="capital">
                            <span class="checkbox-label">
                                <strong>Capital Preservation & Growth</strong>
                                <span>Managing and growing family wealth</span>
                            </span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="focus" value="relationships">
                            <span class="checkbox-label">
                                <strong>Relationships & Unity</strong>
                                <span>Building strong family bonds</span>
                            </span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="focus" value="education">
                            <span class="checkbox-label">
                                <strong>Education & Development</strong>
                                <span>Investing in children's growth</span>
                            </span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="focus" value="philanthropy">
                            <span class="checkbox-label">
                                <strong>Philanthropy & Social Impact</strong>
                                <span>Making a difference in the world</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Text Style Preference</label>
                    <div class="radio-group">
                        <label class="radio-item">
                            <input type="radio" name="text-style" value="formal">
                            <span class="radio-label">
                                <strong>Formal</strong>
                                <span>Professional and traditional language</span>
                            </span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="text-style" value="neutral" checked>
                            <span class="radio-label">
                                <strong>Neutral</strong>
                                <span>Balanced and clear communication</span>
                            </span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="text-style" value="warm">
                            <span class="radio-label">
                                <strong>Warm & Personal</strong>
                                <span>Heartfelt and human language</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Inspirational Level: <span id="inspiration-value">Moderate</span></label>
                    <input type="range" class="slider" id="inspiration-level" min="1" max="3" value="2"
                           oninput="updateInspirationLabel(this.value)">
                    <div class="slider-labels">
                        <span>Grounded</span>
                        <span>Moderate</span>
                        <span>Inspiring</span>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Continue ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 2: Value Packs Selection -->
        <div id="step-2" class="step-hidden">
            <div class="card">
                <h2>Step 2: Quick Value Discovery</h2>
                <p>Select value packs that resonate with your family. Don't overthink it‚Äîgo with your instincts!</p>

                <div class="alert alert-info">
                    <strong>Tip:</strong> Select all packs that feel relevant. You'll refine specific values in the next step.
                </div>

                <div class="value-cards" id="value-packs-container">
                    <!-- Value packs will be generated here -->
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Continue to Values ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 3: Individual Value Cards (Swipe/Like) -->
        <div id="step-3" class="step-hidden">
            <div class="card">
                <h2>Step 3: Rate Individual Values</h2>
                <p>Based on your selected packs, rate these specific values. We'll use your input to create your final value list.</p>

                <div class="timer">
                    <span>‚è±</span>
                    <span>Time remaining: <span id="step3-timer">15:00</span></span>
                </div>

                <div id="value-card-swiper">
                    <div class="card" style="border: 2px solid var(--border);">
                        <div class="value-card-icon">ü§ù</div>
                        <h3 id="current-value-name">Trust</h3>
                        <p id="current-value-description">We speak truth to each other and keep our promises. Trust forms the foundation of all family relationships.</p>

                        <div class="vote-buttons">
                            <button class="vote-btn" onclick="rateValue('important')">
                                ‚ù§Ô∏è Important
                            </button>
                            <button class="vote-btn" onclick="rateValue('neutral')">
                                ü§∑ Neutral
                            </button>
                            <button class="vote-btn" onclick="rateValue('not-us')">
                                ‚ùå Not Us
                            </button>
                        </div>

                        <div style="text-align: center; margin-top: var(--spacing-lg); color: var(--text-muted); font-size: var(--font-size-sm);">
                            Card <span id="card-counter">1</span> of <span id="card-total">20</span>
                        </div>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                </div>
            </div>
        </div>

        <!-- Step 4: Values Clustering & Voting -->
        <div id="step-4" class="step-hidden">
            <div class="card">
                <h2>Step 4: Finalize Your Core Values</h2>
                <p>AI has grouped similar values into clusters. Select your top 5-7 core values.</p>

                <div class="alert alert-success">
                    <strong>AI Analysis Complete:</strong> We've identified 12 value clusters from your ratings.
                </div>

                <div class="form-group">
                    <label class="form-label">Select 5-7 Core Values</label>
                    <div class="checkbox-group" id="clustered-values">
                        <!-- Clustered values will appear here -->
                    </div>
                </div>

                <h3 style="margin-top: var(--spacing-xl);">Refine Descriptions</h3>
                <p>Adjust how your values are expressed:</p>

                <div class="btn-group" style="flex-wrap: wrap;">
                    <button class="btn btn-secondary" onclick="refineValues('shorter')">Make Shorter</button>
                    <button class="btn btn-secondary" onclick="refineValues('simpler')">Simpler Language</button>
                    <button class="btn btn-secondary" onclick="refineValues('formal')">More Formal</button>
                    <button class="btn btn-secondary" onclick="refineValues('examples')">Add Examples</button>
                </div>

                <div id="values-preview" class="results-section" style="margin-top: var(--spacing-lg); display: none;">
                    <h3>Your Core Values</h3>
                    <ul class="results-list" id="final-values-list">
                        <!-- Final values will appear here -->
                    </ul>
                </div>

                <div class="btn-group">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep()">Continue to Mission ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 5: Mission Statement Generation -->
        <div id="step-5" class="step-hidden">
            <div class="card">
                <h2>Step 5: AI Mission Builder</h2>
                <p>Let's create your family mission statement. Start by selecting a mission archetype.</p>

                <div class="form-group">
                    <label class="form-label">Mission Archetype</label>
                    <div class="radio-group">
                        <label class="radio-item">
                            <input type="radio" name="mission-archetype" value="family-support" checked>
                            <span class="radio-label">
                                <strong>Family as Foundation</strong>
                                <span>Focus on relationships, support, and well-being of family members</span>
                            </span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="mission-archetype" value="capital-steward">
                            <span class="radio-label">
                                <strong>Capital Stewardship</strong>
                                <span>Focus on responsible wealth management and intergenerational transfer</span>
                            </span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="mission-archetype" value="entrepreneur">
                            <span class="radio-label">
                                <strong>Entrepreneurial Family</strong>
                                <span>Focus on business creation, innovation, and growth</span>
                            </span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="mission-archetype" value="philanthropist">
                            <span class="radio-label">
                                <strong>Philanthropic Family</strong>
                                <span>Focus on social impact and helping others</span>
                            </span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Balance Your Focus</label>
                    <div style="margin-bottom: var(--spacing-md);">
                        <label class="form-label" style="font-size: var(--font-size-sm);">
                            Family Focus: <span id="focus-family-val">50</span>%
                        </label>
                        <input type="range" class="slider" id="focus-family" min="0" max="100" value="50"
                               oninput="updateFocusBalance()">
                    </div>
                    <div style="margin-bottom: var(--spacing-md);">
                        <label class="form-label" style="font-size: var(--font-size-sm);">
                            Business Focus: <span id="focus-business-val">30</span>%
                        </label>
                        <input type="range" class="slider" id="focus-business" min="0" max="100" value="30"
                               oninput="updateFocusBalance()">
                    </div>
                    <div>
                        <label class="form-label" style="font-size: var(--font-size-sm);">
                            Society Focus: <span id="focus-society-val">20</span>%
                        </label>
                        <input type="range" class="slider" id="focus-society" min="0" max="100" value="20"
                               oninput="updateFocusBalance()">
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Mission Length</label>
                    <div class="radio-group" style="flex-direction: row; gap: var(--spacing-lg);">
                        <label class="radio-item">
                            <input type="radio" name="mission-length" value="short" checked>
                            <span class="radio-label"><strong>1 Sentence</strong></span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="mission-length" value="medium">
                            <span class="radio-label"><strong>2-3 Sentences</strong></span>
                        </label>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="generateMission()" style="width: 100%;">
                    ‚ú® Generate Mission Options
                </button>

                <div id="mission-options" style="margin-top: var(--spacing-xl); display: none;">
                    <h3>Choose Your Favorite</h3>
                    <div class="radio-group">
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="mission-choice" value="option1" checked>
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="mission-option-1"></p>
                                </div>
                            </span>
                        </label>
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="mission-choice" value="option2">
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="mission-option-2"></p>
                                </div>
                            </span>
                        </label>
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="mission-choice" value="option3">
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="mission-option-3"></p>
                                </div>
                            </span>
                        </label>
                    </div>

                    <h3 style="margin-top: var(--spacing-xl);">Refine Your Choice</h3>
                    <div class="btn-group" style="flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="refineMission('shorter')">Make Shorter</button>
                        <button class="btn btn-secondary" onclick="refineMission('less-pafos')">Less Inspirational</button>
                        <button class="btn btn-secondary" onclick="refineMission('more-inspiring')">More Inspiring</button>
                    </div>
                </div>

                <div class="btn-group" style="margin-top: var(--spacing-xl);">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep()" id="mission-next-btn" disabled>Continue to Vision ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 6: Vision Statement Generation -->
        <div id="step-6" class="step-hidden">
            <div class="card">
                <h2>Step 6: AI Vision Builder</h2>
                <p>Now let's create your family vision‚Äîa picture of your desired future.</p>

                <div class="form-group">
                    <label class="form-label">Select Future Scenarios (choose 3-5)</label>
                    <div class="value-cards" id="vision-scenarios">
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="strong-business">
                            <div class="value-card-icon">üè¢</div>
                            <div class="value-card-title">Strong Family Business</div>
                            <div class="value-card-description">Thriving business passed to next generation</div>
                        </div>
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="educated-children">
                            <div class="value-card-icon">üéì</div>
                            <div class="value-card-title">Educated & Independent Children</div>
                            <div class="value-card-description">Self-sufficient next generation</div>
                        </div>
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="philanthropy">
                            <div class="value-card-icon">‚ù§Ô∏è</div>
                            <div class="value-card-title">Active Philanthropy</div>
                            <div class="value-card-description">Making meaningful social impact</div>
                        </div>
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="family-office">
                            <div class="value-card-icon">üíº</div>
                            <div class="value-card-title">Professional Family Office</div>
                            <div class="value-card-description">Structured wealth management</div>
                        </div>
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="unity">
                            <div class="value-card-icon">ü§ó</div>
                            <div class="value-card-title">Family Unity</div>
                            <div class="value-card-description">Strong relationships across generations</div>
                        </div>
                        <div class="value-card" onclick="toggleVisionCard(this)" data-scenario="global">
                            <div class="value-card-icon">üåç</div>
                            <div class="value-card-title">Global Presence</div>
                            <div class="value-card-description">International family footprint</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Vision Horizon: <span id="vision-horizon-val">20</span> years</label>
                    <input type="range" class="slider" id="vision-horizon" min="10" max="50" value="20" step="5"
                           oninput="document.getElementById('vision-horizon-val').textContent = this.value">
                    <div class="slider-labels">
                        <span>10 years</span>
                        <span>30 years</span>
                        <span>50+ years</span>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Level of Detail</label>
                    <div class="radio-group" style="flex-direction: row; gap: var(--spacing-lg);">
                        <label class="radio-item">
                            <input type="radio" name="vision-detail" value="general" checked>
                            <span class="radio-label"><strong>General Picture</strong></span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="vision-detail" value="medium">
                            <span class="radio-label"><strong>Medium Detail</strong></span>
                        </label>
                        <label class="radio-item">
                            <input type="radio" name="vision-detail" value="concrete">
                            <span class="radio-label"><strong>Quite Concrete</strong></span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">Emphasize (optional)</label>
                    <div class="checkbox-group">
                        <label class="checkbox-item">
                            <input type="checkbox" name="vision-emphasis" value="wealth-transfer">
                            <span class="checkbox-label"><strong>Wealth Transfer to Next Generation</strong></span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="vision-emphasis" value="next-gen-role">
                            <span class="checkbox-label"><strong>Role of Next Generation</strong></span>
                        </label>
                        <label class="checkbox-item">
                            <input type="checkbox" name="vision-emphasis" value="social-work">
                            <span class="checkbox-label"><strong>Social Work & Philanthropy</strong></span>
                        </label>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="generateVision()" style="width: 100%;">
                    ‚ú® Generate Vision Options
                </button>

                <div id="vision-options" style="margin-top: var(--spacing-xl); display: none;">
                    <h3>Choose Your Favorite Vision</h3>
                    <div class="radio-group">
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="vision-choice" value="option1" checked>
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="vision-option-1"></p>
                                </div>
                            </span>
                        </label>
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="vision-choice" value="option2">
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="vision-option-2"></p>
                                </div>
                            </span>
                        </label>
                        <label class="radio-item" style="border: 1px solid var(--border); border-radius: var(--radius-md); padding: var(--spacing-md); cursor: pointer;">
                            <input type="radio" name="vision-choice" value="option3">
                            <span class="radio-label">
                                <div class="generated-preview" style="margin-top: var(--spacing-sm);">
                                    <p class="generated-preview-text" id="vision-option-3"></p>
                                </div>
                            </span>
                        </label>
                    </div>

                    <h3 style="margin-top: var(--spacing-xl);">Refine Your Vision</h3>
                    <div class="btn-group" style="flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="refineVision('shorter')">Make Shorter</button>
                        <button class="btn btn-secondary" onclick="refineVision('next-gen')">+ Focus on Children</button>
                        <button class="btn btn-secondary" onclick="refineVision('business')">+ Focus on Business</button>
                        <button class="btn btn-secondary" onclick="refineVision('informal')">Less Formal</button>
                    </div>
                </div>

                <div class="btn-group" style="margin-top: var(--spacing-xl);">
                    <button class="btn btn-secondary" onclick="previousStep()">‚Üê Back</button>
                    <button class="btn btn-primary" onclick="nextStep()" id="vision-next-btn" disabled>Continue to Summary ‚Üí</button>
                </div>
            </div>
        </div>

        <!-- Step 7: Final Summary & PDF -->
        <div id="step-7" class="step-hidden">
            <div class="card">
                <h2>üéâ Congratulations!</h2>
                <p>You've completed your Family Values, Mission & Vision workshop. Review your results below.</p>

                <div class="alert alert-success">
                    <strong>Workshop Completed:</strong> All participants can now review and approve the final document.
                </div>

                <div class="results-section">
                    <h3>üìã Core Family Values</h3>
                    <ul class="results-list" id="summary-values">
                        <!-- Values will be populated here -->
                    </ul>
                </div>

                <div class="results-section">
                    <h3>üéØ Mission Statement</h3>
                    <div class="generated-preview">
                        <p class="generated-preview-text" id="summary-mission"></p>
                    </div>
                </div>

                <div class="results-section">
                    <h3>üî≠ Vision Statement</h3>
                    <div class="generated-preview">
                        <p class="generated-preview-text" id="summary-vision"></p>
                    </div>
                </div>

                <h3 style="margin-top: var(--spacing-xl);">Next Steps</h3>
                <div class="checkbox-group">
                    <label class="checkbox-item">
                        <input type="checkbox" id="approve-member-1">
                        <span class="checkbox-label">
                            <strong>Member 1: Approve & Sign</strong>
                        </span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="approve-member-2">
                        <span class="checkbox-label">
                            <strong>Member 2: Approve & Sign</strong>
                        </span>
                    </label>
                    <label class="checkbox-item">
                        <input type="checkbox" id="approve-member-3">
                        <span class="checkbox-label">
                            <strong>Member 3: Approve & Sign</strong>
                        </span>
                    </label>
                </div>

                <div class="btn-group" style="margin-top: var(--spacing-xl);">
                    <button class="btn btn-secondary" onclick="exportJSON()">üíæ Export Data (JSON)</button>
                    <button class="btn btn-secondary" onclick="exportText()">üìÑ Export Text</button>
                    <button class="btn btn-primary" onclick="generatePDF()">üì• Download PDF Document</button>
                </div>

                <div style="text-align: center; margin-top: var(--spacing-xl); padding-top: var(--spacing-xl); border-top: 1px solid var(--border);">
                    <button class="btn btn-secondary" onclick="restartWorkshop()">‚Üª Start New Workshop</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Workshop State Management
        let workshopState = {
            currentStep: 0,
            totalSteps: 7,
            profile: {},
            selectedValuePacks: [],
            valueRatings: [],
            finalValues: [],
            mission: '',
            vision: '',
            currentValueIndex: 0,
            allValues: []
        };

        // Value Packs Database
        const valuePacks = [
            { id: 'unity', icon: 'ü§ù', name: 'Family Unity', description: 'Strong bonds, mutual support, and togetherness' },
            { id: 'capital', icon: 'üí∞', name: 'Responsible Capital Ownership', description: 'Prudent wealth management and stewardship' },
            { id: 'entrepreneur', icon: 'üöÄ', name: 'Entrepreneurial Spirit', description: 'Innovation, risk-taking, and business creation' },
            { id: 'education', icon: 'üìö', name: 'Education & Development', description: 'Continuous learning and personal growth' },
            { id: 'tradition', icon: 'üèõÔ∏è', name: 'Tradition & Continuity', description: 'Honoring heritage and passing wisdom' },
            { id: 'philanthropy', icon: '‚ù§Ô∏è', name: 'Philanthropy & Service', description: 'Giving back and social responsibility' },
            { id: 'freedom', icon: 'ü¶ã', name: 'Personal Freedom & Self-Realization', description: 'Individual autonomy and fulfillment' },
            { id: 'integrity', icon: '‚öñÔ∏è', name: 'Integrity & Ethics', description: 'Honesty, transparency, and moral principles' }
        ];

        // Individual Values Database (simplified for prototype)
        const individualValues = [
            { id: 'trust', name: 'Trust', description: 'We speak truth to each other and keep our promises. Trust forms the foundation of all family relationships.', icon: 'ü§ù', pack: 'unity' },
            { id: 'respect', name: 'Respect', description: 'We honor each person\'s individuality and perspectives, treating everyone with dignity.', icon: 'üôè', pack: 'unity' },
            { id: 'accountability', name: 'Accountability', description: 'We take ownership of our actions and commitments to the family and business.', icon: '‚úì', pack: 'capital' },
            { id: 'prudence', name: 'Prudence', description: 'We make careful, well-informed decisions about family resources and investments.', icon: 'üéØ', pack: 'capital' },
            { id: 'innovation', name: 'Innovation', description: 'We embrace new ideas and are willing to adapt to changing circumstances.', icon: 'üí°', pack: 'entrepreneur' },
            { id: 'resilience', name: 'Resilience', description: 'We bounce back from setbacks and view challenges as opportunities to grow.', icon: 'üí™', pack: 'entrepreneur' },
            { id: 'curiosity', name: 'Curiosity', description: 'We foster lifelong learning and encourage questions and exploration.', icon: 'üîç', pack: 'education' },
            { id: 'excellence', name: 'Excellence', description: 'We strive for quality in everything we do, from education to business to relationships.', icon: '‚≠ê', pack: 'education' },
            { id: 'heritage', name: 'Heritage', description: 'We remember and honor where we came from, preserving family stories and traditions.', icon: 'üìú', pack: 'tradition' },
            { id: 'continuity', name: 'Continuity', description: 'We build bridges between generations, ensuring smooth transitions.', icon: 'üåâ', pack: 'tradition' },
            { id: 'generosity', name: 'Generosity', description: 'We share our time, resources, and expertise to help others.', icon: 'üéÅ', pack: 'philanthropy' },
            { id: 'compassion', name: 'Compassion', description: 'We approach others with empathy and seek to understand their experiences.', icon: 'üíô', pack: 'philanthropy' },
            { id: 'autonomy', name: 'Autonomy', description: 'We support each family member in making their own life choices.', icon: 'üóΩ', pack: 'freedom' },
            { id: 'authenticity', name: 'Authenticity', description: 'We encourage everyone to be their true selves without pretense.', icon: '‚ú®', pack: 'freedom' },
            { id: 'honesty', name: 'Honesty', description: 'We communicate truthfully, even when it\'s difficult.', icon: 'üí¨', pack: 'integrity' },
            { id: 'transparency', name: 'Transparency', description: 'We share information openly and operate with clarity.', icon: 'üî¨', pack: 'integrity' },
            { id: 'loyalty', name: 'Loyalty', description: 'We stand by each other through good times and challenges.', icon: 'üõ°Ô∏è', pack: 'unity' },
            { id: 'collaboration', name: 'Collaboration', description: 'We work together, combining our strengths to achieve common goals.', icon: 'ü§≤', pack: 'unity' },
            { id: 'sustainability', name: 'Sustainability', description: 'We think long-term and make decisions that benefit future generations.', icon: 'üå±', pack: 'capital' },
            { id: 'courage', name: 'Courage', description: 'We face difficult decisions and have hard conversations when necessary.', icon: 'ü¶Å', pack: 'entrepreneur' }
        ];

        // Initialize Workshop
        function startWorkshop() {
            currentStep = 1;
            showStep(1);
        }

        // Step Navigation
        function nextStep() {
            if (validateCurrentStep()) {
                currentStep++;
                showStep(currentStep);
            }
        }

        function previousStep() {
            currentStep--;
            showStep(currentStep);
        }

        function showStep(stepNum) {
            // Hide all steps
            for (let i = 0; i <= workshopState.totalSteps; i++) {
                const stepEl = document.getElementById(`step-${i}`);
                if (stepEl) {
                    stepEl.classList.remove('step-visible');
                    stepEl.classList.add('step-hidden');
                }
            }

            // Show current step
            const currentStepEl = document.getElementById(`step-${stepNum}`);
            if (currentStepEl) {
                currentStepEl.classList.remove('step-hidden');
                currentStepEl.classList.add('step-visible');
            }

            // Update progress
            updateProgress(stepNum);

            // Initialize step-specific content
            if (stepNum === 2) initializeValuePacks();
            if (stepNum === 3) initializeValueSwiper();
            if (stepNum === 4) initializeValueClustering();
            if (stepNum === 7) initializeSummary();

            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function updateProgress(stepNum) {
            const percentage = Math.round((stepNum / workshopState.totalSteps) * 100);
            document.getElementById('progress-fill').style.width = `${percentage}%`;
            document.getElementById('progress-percentage').textContent = `${percentage}%`;

            const stepLabels = [
                'Introduction',
                'Family Profile',
                'Value Packs',
                'Rate Values',
                'Finalize Values',
                'Mission Statement',
                'Vision Statement',
                'Summary & Export'
            ];

            document.getElementById('progress-step-label').textContent = stepLabels[stepNum] || 'Workshop';
        }

        function validateCurrentStep() {
            // Add validation logic as needed
            return true;
        }

        // Step 1: Helper Functions
        function updateInspirationLabel(value) {
            const labels = ['Grounded', 'Moderate', 'Inspiring'];
            document.getElementById('inspiration-value').textContent = labels[value - 1];
        }

        // Step 2: Initialize Value Packs
        function initializeValuePacks() {
            const container = document.getElementById('value-packs-container');
            container.innerHTML = '';

            valuePacks.forEach(pack => {
                const card = document.createElement('div');
                card.className = 'value-card';
                card.onclick = () => toggleValuePack(card, pack.id);
                card.dataset.packId = pack.id;
                card.innerHTML = `
                    <div class="value-card-icon">${pack.icon}</div>
                    <div class="value-card-title">${pack.name}</div>
                    <div class="value-card-description">${pack.description}</div>
                `;
                container.appendChild(card);
            });
        }

        function toggleValuePack(element, packId) {
            element.classList.toggle('selected');
            const index = workshopState.selectedValuePacks.indexOf(packId);
            if (index === -1) {
                workshopState.selectedValuePacks.push(packId);
            } else {
                workshopState.selectedValuePacks.splice(index, 1);
            }
        }

        // Step 3: Value Swiper
        function initializeValueSwiper() {
            // Filter values based on selected packs
            workshopState.allValues = individualValues.filter(v =>
                workshopState.selectedValuePacks.includes(v.pack) ||
                workshopState.selectedValuePacks.length === 0
            );
            workshopState.currentValueIndex = 0;
            workshopState.valueRatings = [];

            document.getElementById('card-total').textContent = workshopState.allValues.length;
            showCurrentValue();
            startTimer('step3-timer', 15 * 60);
        }

        function showCurrentValue() {
            if (workshopState.currentValueIndex >= workshopState.allValues.length) {
                nextStep();
                return;
            }

            const value = workshopState.allValues[workshopState.currentValueIndex];
            document.getElementById('current-value-name').textContent = value.name;
            document.getElementById('current-value-description').textContent = value.description;
            document.querySelector('.value-card-icon').textContent = value.icon;
            document.getElementById('card-counter').textContent = workshopState.currentValueIndex + 1;
        }

        function rateValue(rating) {
            const value = workshopState.allValues[workshopState.currentValueIndex];
            workshopState.valueRatings.push({
                valueId: value.id,
                name: value.name,
                description: value.description,
                rating: rating
            });

            workshopState.currentValueIndex++;
            showCurrentValue();
        }

        function startTimer(elementId, seconds) {
            let remaining = seconds;
            const element = document.getElementById(elementId);

            const interval = setInterval(() => {
                remaining--;
                const mins = Math.floor(remaining / 60);
                const secs = remaining % 60;
                element.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;

                if (remaining <= 0) {
                    clearInterval(interval);
                }
            }, 1000);
        }

        // Step 4: Value Clustering
        function initializeValueClustering() {
            const container = document.getElementById('clustered-values');
            container.innerHTML = '';

            // Simulate AI clustering - group important values
            const importantValues = workshopState.valueRatings.filter(v => v.rating === 'important');

            importantValues.slice(0, 12).forEach(value => {
                const item = document.createElement('label');
                item.className = 'checkbox-item';
                item.innerHTML = `
                    <input type="checkbox" name="final-values" value="${value.valueId}">
                    <span class="checkbox-label">
                        <strong>${value.name}</strong>
                        <span>${value.description}</span>
                    </span>
                `;
                container.appendChild(item);
            });
        }

        function refineValues(action) {
            // Simulate AI refinement
            const checkedBoxes = document.querySelectorAll('input[name="final-values"]:checked');
            workshopState.finalValues = Array.from(checkedBoxes).map(cb => {
                const value = workshopState.valueRatings.find(v => v.valueId === cb.value);
                return {
                    name: value.name,
                    description: modifyDescription(value.description, action)
                };
            });

            displayFinalValues();
        }

        function modifyDescription(text, action) {
            // Simulate AI text modification
            switch(action) {
                case 'shorter':
                    return text.split('.')[0] + '.';
                case 'simpler':
                    return text.replace(/[,;]/g, '.').split('.')[0] + '.';
                case 'formal':
                    return 'The family commits to ' + text.toLowerCase();
                case 'examples':
                    return text + ' For example, in daily interactions and major decisions.';
                default:
                    return text;
            }
        }

        function displayFinalValues() {
            const preview = document.getElementById('values-preview');
            const list = document.getElementById('final-values-list');
            list.innerHTML = '';

            workshopState.finalValues.forEach(value => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <strong>${value.name}</strong>
                    <p>${value.description}</p>
                `;
                list.appendChild(li);
            });

            preview.style.display = 'block';
        }

        // Step 5: Mission Generation
        function updateFocusBalance() {
            document.getElementById('focus-family-val').textContent = document.getElementById('focus-family').value;
            document.getElementById('focus-business-val').textContent = document.getElementById('focus-business').value;
            document.getElementById('focus-society-val').textContent = document.getElementById('focus-society').value;
        }

        function generateMission() {
            // Simulate AI generation
            const archetype = document.querySelector('input[name="mission-archetype"]:checked').value;
            const length = document.querySelector('input[name="mission-length"]:checked').value;

            const missions = {
                'family-support': [
                    'Our mission is to nurture strong, supportive relationships while responsibly managing our family wealth for future generations.',
                    'We exist to create a loving, resilient family that supports each member\'s growth and maintains our values across generations.',
                    'We are committed to building a family foundation of trust, respect, and mutual support that empowers every member to thrive.'
                ],
                'capital-steward': [
                    'Our mission is to preserve and grow our family capital through responsible stewardship, ensuring prosperity for generations to come.',
                    'We exist to manage our wealth with prudence and integrity, creating lasting value for our family and community.',
                    'We are dedicated to protecting and enhancing our family\'s financial legacy while maintaining our core values.'
                ],
                'entrepreneur': [
                    'Our mission is to foster entrepreneurial spirit and innovation, creating businesses that reflect our values and benefit society.',
                    'We exist to build sustainable enterprises that embody our family values and create opportunities for future generations.',
                    'We are committed to entrepreneurial excellence, turning our vision into thriving businesses that make a difference.'
                ],
                'philanthropist': [
                    'Our mission is to leverage our resources and talents to create meaningful positive change in our community and beyond.',
                    'We exist to serve others through strategic philanthropy, making a lasting impact on causes we care about.',
                    'We are dedicated to using our blessings to help others, creating a legacy of generosity and social responsibility.'
                ]
            };

            const options = missions[archetype] || missions['family-support'];
            document.getElementById('mission-option-1').textContent = options[0];
            document.getElementById('mission-option-2').textContent = options[1];
            document.getElementById('mission-option-3').textContent = options[2];

            document.getElementById('mission-options').style.display = 'block';
            document.getElementById('mission-next-btn').disabled = false;

            // Set the first option as selected mission
            workshopState.mission = options[0];
        }

        function refineMission(action) {
            const selectedOption = document.querySelector('input[name="mission-choice"]:checked').value;
            const optionNum = selectedOption.replace('option', '');
            const element = document.getElementById(`mission-option-${optionNum}`);
            let text = element.textContent;

            switch(action) {
                case 'shorter':
                    text = text.split(',')[0] + '.';
                    break;
                case 'less-pafos':
                    text = text.replace(/nurture|thrive|embody|leverage/gi, 'support').replace(/lasting|meaningful/gi, '');
                    break;
                case 'more-inspiring':
                    text = text.replace(/manage|support/gi, 'champion').replace(/maintain/gi, 'uphold');
                    break;
            }

            element.textContent = text;
            workshopState.mission = text;
        }

        // Step 6: Vision Generation
        function toggleVisionCard(element) {
            element.classList.toggle('selected');
        }

        function generateVision() {
            const visions = [
                'In 20 years, our family will be united across generations, with each member pursuing their passions while contributing to our shared mission. Our businesses and investments will provide security and opportunity, and our philanthropic work will have created lasting positive change in our community.',
                'We envision a future where our family operates as a thriving multi-generational partnership. Our children will be educated, independent thinkers who choose to stay connected to family values and legacy. Our wealth will be professionally managed and growing, supporting both family needs and meaningful social impact.',
                'Our vision is a family where strong relationships transcend geography and generation. We will maintain successful business operations that reflect our values, while each family member flourishes in their chosen path. We will be known for both our business success and our commitment to giving back.'
            ];

            document.getElementById('vision-option-1').textContent = visions[0];
            document.getElementById('vision-option-2').textContent = visions[1];
            document.getElementById('vision-option-3').textContent = visions[2];

            document.getElementById('vision-options').style.display = 'block';
            document.getElementById('vision-next-btn').disabled = false;

            workshopState.vision = visions[0];
        }

        function refineVision(action) {
            const selectedOption = document.querySelector('input[name="vision-choice"]:checked').value;
            const optionNum = selectedOption.replace('option', '');
            const element = document.getElementById(`vision-option-${optionNum}`);
            let text = element.textContent;

            switch(action) {
                case 'shorter':
                    text = text.split('.').slice(0, 2).join('.') + '.';
                    break;
                case 'next-gen':
                    text = text + ' Our children and grandchildren will be the heart of everything we do.';
                    break;
                case 'business':
                    text = text + ' Our business ventures will continue to grow and innovate.';
                    break;
                case 'informal':
                    text = text.replace(/We envision|Our vision is/gi, 'We see').replace(/will be/gi, "we'll be");
                    break;
            }

            element.textContent = text;
            workshopState.vision = text;
        }

        // Step 7: Summary
        function initializeSummary() {
            // Populate values
            const valuesList = document.getElementById('summary-values');
            valuesList.innerHTML = '';

            // Use final values if available, otherwise use top rated
            let displayValues = workshopState.finalValues;
            if (displayValues.length === 0) {
                displayValues = workshopState.valueRatings
                    .filter(v => v.rating === 'important')
                    .slice(0, 5)
                    .map(v => ({ name: v.name, description: v.description }));
            }

            displayValues.forEach(value => {
                const li = document.createElement('li');
                li.innerHTML = `
                    <strong>${value.name}</strong>
                    <p>${value.description}</p>
                `;
                valuesList.appendChild(li);
            });

            // Populate mission
            document.getElementById('summary-mission').textContent = workshopState.mission ||
                'Our mission is to build a strong, values-driven family that supports each member while creating lasting positive impact.';

            // Populate vision
            document.getElementById('summary-vision').textContent = workshopState.vision ||
                'We envision a thriving multi-generational family where each member flourishes while staying connected to our shared values and legacy.';
        }

        function exportJSON() {
            const data = {
                workshopDate: new Date().toISOString(),
                values: workshopState.finalValues.length > 0 ? workshopState.finalValues :
                    workshopState.valueRatings.filter(v => v.rating === 'important').slice(0, 5),
                mission: workshopState.mission,
                vision: workshopState.vision,
                profile: workshopState.profile
            };

            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'family-workshop-results.json';
            a.click();
        }

        function exportText() {
            let text = 'FAMILY VALUES, MISSION & VISION\n';
            text += '=' .repeat(50) + '\n\n';
            text += `Date: ${new Date().toLocaleDateString()}\n\n`;

            text += 'CORE VALUES\n' + '-'.repeat(50) + '\n';
            const displayValues = workshopState.finalValues.length > 0 ? workshopState.finalValues :
                workshopState.valueRatings.filter(v => v.rating === 'important').slice(0, 5);
            displayValues.forEach((v, i) => {
                text += `${i + 1}. ${v.name}\n   ${v.description}\n\n`;
            });

            text += '\nMISSION STATEMENT\n' + '-'.repeat(50) + '\n';
            text += workshopState.mission + '\n\n';

            text += '\nVISION STATEMENT\n' + '-'.repeat(50) + '\n';
            text += workshopState.vision + '\n';

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'family-workshop-results.txt';
            a.click();
        }

        function generatePDF() {
            alert('PDF generation would integrate with a backend service. For this prototype, please use "Export Text" or "Export Data (JSON)" options.');
        }

        function restartWorkshop() {
            if (confirm('Are you sure you want to start over? All current progress will be lost.')) {
                workshopState = {
                    currentStep: 0,
                    totalSteps: 7,
                    profile: {},
                    selectedValuePacks: [],
                    valueRatings: [],
                    finalValues: [],
                    mission: '',
                    vision: '',
                    currentValueIndex: 0,
                    allValues: []
                };
                showStep(0);
            }
        }

        // Initialize on page load
        let currentStep = 0;
    </script>
</body>
</html>
